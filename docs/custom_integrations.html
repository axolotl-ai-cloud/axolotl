<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Custom Integrations â€“ Axolotl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../favicon.jpg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-4d9afe2b8d18ee9fa5d0d57b5ed4214d.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-08d9eb451d58809f35fda8b852d737d8.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-9KYCVJBNMQ"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-9KYCVJBNMQ', { 'anonymize_ip': true});
</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../image/axolotl_logo_digital_white.svg" alt="" class="navbar-logo light-content">
    <img src="../image/axolotl_logo_digital_white.svg" alt="" class="navbar-logo dark-content">
    </a>
  </div>
        <div class="quarto-navbar-tools tools-wide tools-end">
    <a href="https://twitter.com/axolotl_ai" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/axolotl-ai-cloud/axolotl/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <a href="https://discord.gg/7m9sfhzaf3" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-discord"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../docs/fsdp_qlora.html">Advanced Features</a></li><li class="breadcrumb-item"><a href="../docs/custom_integrations.html">Custom Integrations</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Getting Started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/getting-started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quickstart</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/installation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Installation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inference and Merging</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Model Guides</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/kimi-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kimi Linear</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/plano.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plano Orchestrator</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/mimo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MiMo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/internvl3_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">InternVL 3.5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/olmo3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OLMo 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/trinity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Trinity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/arcee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Arcee AFM</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Ministral3</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/ministral3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ministral3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/ministral3/think.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ministral 3 Thinking</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/ministral3/vision.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ministral 3 Vision</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Magistral</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/magistral.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Magistral</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/magistral/think.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Magistral Thinking</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/magistral/vision.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Magistral Vision</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/ministral.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ministral</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/mistral-small.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mistral Small 3.1/3.2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/voxtral.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Voxtral</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/devstral.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Devstral</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/mistral.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mistral 7B</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/llama-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Llama 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/llama-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Llama 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/qwen3-next.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Qwen 3 Next</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/qwen3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Qwen 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/gemma3n.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gemma 3n</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/apertus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Apertus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/gpt-oss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GPT-OSS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/seed-oss.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Seed-OSS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/phi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Phi</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/smolvlm2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SmolVLM 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/granite4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Granite 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/LiquidAI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Liquid Foundation Models 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/hunyuan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hunyuan</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/jamba.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Jamba</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/models/orpheus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Orpheus</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/cli.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Command Line Interface (CLI)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/telemetry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Telemetry</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/config-reference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Config Reference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/api" class="sidebar-item-text sidebar-link">
 <span class="menu-text">API Reference</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../docs/dataset-formats/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dataset Formats</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/dataset-formats/pretraining.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pre-training</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/dataset-formats/inst_tune.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instruction Tuning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/dataset-formats/conversation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conversation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/dataset-formats/stepwise_supervised.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stepwise Supervised Format</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/dataset-formats/template_free.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Template-Free</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/dataset-formats/tokenized.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Custom Pre-Tokenized Dataset</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Deployments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/docker.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Docker</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/multi-gpu.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multi-GPU</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/multi-node.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multi Node</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/ray-integration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ray Train</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/amd_hpc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AMD GPUs on HPC Systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/mac.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mac M-series</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">How To Guides</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/multimodal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MultiModal / Vision Language Models (BETA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/rlhf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RLHF (Beta)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/reward_modelling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reward Modelling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/lr_groups.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learning Rate Groups</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/lora_optims.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LoRA Optimizations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/dataset_loading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dataset Loading</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/qat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quantization Aware Training (QAT)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/quantize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quantization with torchao</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/optimizations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optimizations Guide</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Core Concepts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/batch_vs_grad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Batch size vs Gradient accumulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/dataset_preprocessing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dataset Preprocessing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/streaming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Streaming Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/multipack.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multipack (Sample Packing)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/mixed_precision.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed Precision Training</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/optimizers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optimizers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/attention.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Attention</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Features</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/fsdp_qlora.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FSDP + QLoRA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/unsloth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unsloth</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/torchao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PyTorch ao</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/custom_integrations.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Custom Integrations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/sequence_parallelism.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sequence Parallelism</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/gradient_checkpointing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gradient Checkpointing and Activation Offloading</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/nd_parallelism.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">N-D Parallelism (Beta)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true">
 <span class="menu-text">Troubleshooting</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/faq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FAQ</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/debugging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Debugging</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../docs/nccl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NCCL</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#cut-cross-entropy" id="toc-cut-cross-entropy" class="nav-link active" data-scroll-target="#cut-cross-entropy">Cut Cross Entropy</a>
  <ul class="collapse">
  <li><a href="#requirements" id="toc-requirements" class="nav-link" data-scroll-target="#requirements">Requirements</a></li>
  <li><a href="#installation" id="toc-installation" class="nav-link" data-scroll-target="#installation">Installation</a></li>
  <li><a href="#usage" id="toc-usage" class="nav-link" data-scroll-target="#usage">Usage</a></li>
  <li><a href="#supported-models" id="toc-supported-models" class="nav-link" data-scroll-target="#supported-models">Supported Models</a></li>
  <li><a href="#citation" id="toc-citation" class="nav-link" data-scroll-target="#citation">Citation</a></li>
  </ul></li>
  <li><a href="#densemixer" id="toc-densemixer" class="nav-link" data-scroll-target="#densemixer">DenseMixer</a></li>
  <li><a href="#diffusion-lm-training-plugin-for-axolotl" id="toc-diffusion-lm-training-plugin-for-axolotl" class="nav-link" data-scroll-target="#diffusion-lm-training-plugin-for-axolotl">Diffusion LM Training Plugin for Axolotl</a>
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#installation-1" id="toc-installation-1" class="nav-link" data-scroll-target="#installation-1">Installation</a></li>
  <li><a href="#quickstart" id="toc-quickstart" class="nav-link" data-scroll-target="#quickstart">Quickstart</a></li>
  <li><a href="#basic-configuration" id="toc-basic-configuration" class="nav-link" data-scroll-target="#basic-configuration">Basic Configuration</a></li>
  <li><a href="#supported-models-1" id="toc-supported-models-1" class="nav-link" data-scroll-target="#supported-models-1">Supported Models</a></li>
  <li><a href="#how-it-works" id="toc-how-it-works" class="nav-link" data-scroll-target="#how-it-works">How It Works</a></li>
  <li><a href="#random-masking" id="toc-random-masking" class="nav-link" data-scroll-target="#random-masking">Random Masking</a></li>
  <li><a href="#diffusion-loss" id="toc-diffusion-loss" class="nav-link" data-scroll-target="#diffusion-loss">Diffusion Loss</a></li>
  <li><a href="#sample-generation" id="toc-sample-generation" class="nav-link" data-scroll-target="#sample-generation">Sample Generation</a></li>
  <li><a href="#inference" id="toc-inference" class="nav-link" data-scroll-target="#inference">Inference</a></li>
  <li><a href="#metrics-and-monitoring" id="toc-metrics-and-monitoring" class="nav-link" data-scroll-target="#metrics-and-monitoring">Metrics and Monitoring</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations">Limitations</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  <li><a href="#grokfast" id="toc-grokfast" class="nav-link" data-scroll-target="#grokfast">Grokfast</a>
  <ul class="collapse">
  <li><a href="#usage-1" id="toc-usage-1" class="nav-link" data-scroll-target="#usage-1">Usage</a></li>
  <li><a href="#citation-1" id="toc-citation-1" class="nav-link" data-scroll-target="#citation-1">Citation</a></li>
  </ul></li>
  <li><a href="#kernels-integration" id="toc-kernels-integration" class="nav-link" data-scroll-target="#kernels-integration">Kernels Integration</a>
  <ul class="collapse">
  <li><a href="#usage-2" id="toc-usage-2" class="nav-link" data-scroll-target="#usage-2">Usage</a></li>
  <li><a href="#how-it-works-1" id="toc-how-it-works-1" class="nav-link" data-scroll-target="#how-it-works-1">How It Works</a></li>
  <li><a href="#limitations-1" id="toc-limitations-1" class="nav-link" data-scroll-target="#limitations-1">Limitations</a></li>
  <li><a href="#note-on-megablocks" id="toc-note-on-megablocks" class="nav-link" data-scroll-target="#note-on-megablocks">Note on MegaBlocks</a></li>
  </ul></li>
  <li><a href="#knowledge-distillation-kd" id="toc-knowledge-distillation-kd" class="nav-link" data-scroll-target="#knowledge-distillation-kd">Knowledge Distillation (KD)</a>
  <ul class="collapse">
  <li><a href="#usage-3" id="toc-usage-3" class="nav-link" data-scroll-target="#usage-3">Usage</a></li>
  </ul></li>
  <li><a href="#llmcompressor" id="toc-llmcompressor" class="nav-link" data-scroll-target="#llmcompressor">LLMCompressor</a>
  <ul class="collapse">
  <li><a href="#requirements-1" id="toc-requirements-1" class="nav-link" data-scroll-target="#requirements-1">Requirements</a></li>
  <li><a href="#usage-4" id="toc-usage-4" class="nav-link" data-scroll-target="#usage-4">Usage</a></li>
  <li><a href="#storage-optimization-with-save_compressed" id="toc-storage-optimization-with-save_compressed" class="nav-link" data-scroll-target="#storage-optimization-with-save_compressed">Storage Optimization with save_compressed</a></li>
  <li><a href="#example-config" id="toc-example-config" class="nav-link" data-scroll-target="#example-config">Example Config</a></li>
  <li><a href="#inference-with-vllm" id="toc-inference-with-vllm" class="nav-link" data-scroll-target="#inference-with-vllm">Inference with vLLM</a></li>
  <li><a href="#learn-more" id="toc-learn-more" class="nav-link" data-scroll-target="#learn-more">Learn More</a></li>
  </ul></li>
  <li><a href="#language-model-evaluation-harness-lm-eval" id="toc-language-model-evaluation-harness-lm-eval" class="nav-link" data-scroll-target="#language-model-evaluation-harness-lm-eval">Language Model Evaluation Harness (LM Eval)</a>
  <ul class="collapse">
  <li><a href="#usage-5" id="toc-usage-5" class="nav-link" data-scroll-target="#usage-5">Usage</a></li>
  <li><a href="#post-training-evaluation" id="toc-post-training-evaluation" class="nav-link" data-scroll-target="#post-training-evaluation">1. Post-Training Evaluation</a></li>
  <li><a href="#standalone-cli-evaluation" id="toc-standalone-cli-evaluation" class="nav-link" data-scroll-target="#standalone-cli-evaluation">2. Standalone CLI Evaluation</a></li>
  <li><a href="#model-selection-priority" id="toc-model-selection-priority" class="nav-link" data-scroll-target="#model-selection-priority">Model Selection Priority</a></li>
  <li><a href="#citation-2" id="toc-citation-2" class="nav-link" data-scroll-target="#citation-2">Citation</a></li>
  </ul></li>
  <li><a href="#liger-kernels" id="toc-liger-kernels" class="nav-link" data-scroll-target="#liger-kernels">Liger Kernels</a>
  <ul class="collapse">
  <li><a href="#usage-6" id="toc-usage-6" class="nav-link" data-scroll-target="#usage-6">Usage</a></li>
  <li><a href="#supported-models-2" id="toc-supported-models-2" class="nav-link" data-scroll-target="#supported-models-2">Supported Models</a></li>
  <li><a href="#citation-3" id="toc-citation-3" class="nav-link" data-scroll-target="#citation-3">Citation</a></li>
  </ul></li>
  <li><a href="#spectrum" id="toc-spectrum" class="nav-link" data-scroll-target="#spectrum">Spectrum</a>
  <ul class="collapse">
  <li><a href="#overview-1" id="toc-overview-1" class="nav-link" data-scroll-target="#overview-1">Overview</a></li>
  <li><a href="#usage-7" id="toc-usage-7" class="nav-link" data-scroll-target="#usage-7">Usage</a></li>
  <li><a href="#citation-4" id="toc-citation-4" class="nav-link" data-scroll-target="#citation-4">Citation</a></li>
  </ul></li>
  <li><a href="#swanlab-integration-for-axolotl" id="toc-swanlab-integration-for-axolotl" class="nav-link" data-scroll-target="#swanlab-integration-for-axolotl">SwanLab Integration for Axolotl</a>
  <ul class="collapse">
  <li><a href="#features" id="toc-features" class="nav-link" data-scroll-target="#features">Features</a></li>
  <li><a href="#installation-2" id="toc-installation-2" class="nav-link" data-scroll-target="#installation-2">Installation</a></li>
  <li><a href="#quick-start" id="toc-quick-start" class="nav-link" data-scroll-target="#quick-start">Quick Start</a></li>
  <li><a href="#register-for-swanlab-optional-for-cloud-mode" id="toc-register-for-swanlab-optional-for-cloud-mode" class="nav-link" data-scroll-target="#register-for-swanlab-optional-for-cloud-mode">1. Register for SwanLab (Optional for cloud mode)</a></li>
  <li><a href="#configure-axolotl-config-file" id="toc-configure-axolotl-config-file" class="nav-link" data-scroll-target="#configure-axolotl-config-file">2. Configure Axolotl Config File</a></li>
  <li><a href="#run-training" id="toc-run-training" class="nav-link" data-scroll-target="#run-training">3. Run Training</a></li>
  <li><a href="#configuration-options" id="toc-configuration-options" class="nav-link" data-scroll-target="#configuration-options">Configuration Options</a></li>
  <li><a href="#basic-configuration-1" id="toc-basic-configuration-1" class="nav-link" data-scroll-target="#basic-configuration-1">Basic Configuration</a></li>
  <li><a href="#advanced-configuration" id="toc-advanced-configuration" class="nav-link" data-scroll-target="#advanced-configuration">Advanced Configuration</a></li>
  <li><a href="#configuration-examples" id="toc-configuration-examples" class="nav-link" data-scroll-target="#configuration-examples">Configuration Examples</a></li>
  <li><a href="#example-1-basic-cloud-sync" id="toc-example-1-basic-cloud-sync" class="nav-link" data-scroll-target="#example-1-basic-cloud-sync">Example 1: Basic Cloud Sync</a></li>
  <li><a href="#example-2-offlinelocal-mode" id="toc-example-2-offlinelocal-mode" class="nav-link" data-scroll-target="#example-2-offlinelocal-mode">Example 2: Offline/Local Mode</a></li>
  <li><a href="#example-3-team-workspace" id="toc-example-3-team-workspace" class="nav-link" data-scroll-target="#example-3-team-workspace">Example 3: Team Workspace</a></li>
  <li><a href="#example-4-private-deployment" id="toc-example-4-private-deployment" class="nav-link" data-scroll-target="#example-4-private-deployment">Example 4: Private Deployment</a></li>
  <li><a href="#team-notifications-with-lark-feishu" id="toc-team-notifications-with-lark-feishu" class="nav-link" data-scroll-target="#team-notifications-with-lark-feishu">Team Notifications with Lark (Feishu)</a></li>
  <li><a href="#prerequisites" id="toc-prerequisites" class="nav-link" data-scroll-target="#prerequisites">Prerequisites</a></li>
  <li><a href="#example-5-basic-lark-notifications" id="toc-example-5-basic-lark-notifications" class="nav-link" data-scroll-target="#example-5-basic-lark-notifications">Example 5: Basic Lark Notifications</a></li>
  <li><a href="#example-6-lark-notifications-with-hmac-security-recommended" id="toc-example-6-lark-notifications-with-hmac-security-recommended" class="nav-link" data-scroll-target="#example-6-lark-notifications-with-hmac-security-recommended">Example 6: Lark Notifications with HMAC Security (Recommended)</a></li>
  <li><a href="#example-7-team-workspace-lark-notifications" id="toc-example-7-team-workspace-lark-notifications" class="nav-link" data-scroll-target="#example-7-team-workspace-lark-notifications">Example 7: Team Workspace + Lark Notifications</a></li>
  <li><a href="#what-notifications-are-sent" id="toc-what-notifications-are-sent" class="nav-link" data-scroll-target="#what-notifications-are-sent">What Notifications Are Sent?</a></li>
  <li><a href="#lark-configuration-validation" id="toc-lark-configuration-validation" class="nav-link" data-scroll-target="#lark-configuration-validation">Lark Configuration Validation</a></li>
  <li><a href="#security-best-practices" id="toc-security-best-practices" class="nav-link" data-scroll-target="#security-best-practices">Security Best Practices</a></li>
  <li><a href="#distributed-training" id="toc-distributed-training" class="nav-link" data-scroll-target="#distributed-training">Distributed Training</a></li>
  <li><a href="#rlhf-completion-table-logging" id="toc-rlhf-completion-table-logging" class="nav-link" data-scroll-target="#rlhf-completion-table-logging">RLHF Completion Table Logging</a></li>
  <li><a href="#features-1" id="toc-features-1" class="nav-link" data-scroll-target="#features-1">Features</a></li>
  <li><a href="#configuration" id="toc-configuration" class="nav-link" data-scroll-target="#configuration">Configuration</a></li>
  <li><a href="#example-dpo-training-with-completion-logging" id="toc-example-dpo-training-with-completion-logging" class="nav-link" data-scroll-target="#example-dpo-training-with-completion-logging">Example: DPO Training with Completion Logging</a></li>
  <li><a href="#example-disable-completion-logging" id="toc-example-disable-completion-logging" class="nav-link" data-scroll-target="#example-disable-completion-logging">Example: Disable Completion Logging</a></li>
  <li><a href="#supported-rlhf-trainers" id="toc-supported-rlhf-trainers" class="nav-link" data-scroll-target="#supported-rlhf-trainers">Supported RLHF Trainers</a></li>
  <li><a href="#how-it-works-2" id="toc-how-it-works-2" class="nav-link" data-scroll-target="#how-it-works-2">How It Works</a></li>
  <li><a href="#viewing-completion-tables" id="toc-viewing-completion-tables" class="nav-link" data-scroll-target="#viewing-completion-tables">Viewing Completion Tables</a></li>
  <li><a href="#memory-management" id="toc-memory-management" class="nav-link" data-scroll-target="#memory-management">Memory Management</a></li>
  <li><a href="#performance-impact" id="toc-performance-impact" class="nav-link" data-scroll-target="#performance-impact">Performance Impact</a></li>
  <li><a href="#troubleshooting" id="toc-troubleshooting" class="nav-link" data-scroll-target="#troubleshooting">Troubleshooting</a></li>
  <li><a href="#performance-profiling" id="toc-performance-profiling" class="nav-link" data-scroll-target="#performance-profiling">Performance Profiling</a></li>
  <li><a href="#features-2" id="toc-features-2" class="nav-link" data-scroll-target="#features-2">Features</a></li>
  <li><a href="#basic-usage-decorator" id="toc-basic-usage-decorator" class="nav-link" data-scroll-target="#basic-usage-decorator">Basic Usage: Decorator</a></li>
  <li><a href="#advanced-usage-context-manager" id="toc-advanced-usage-context-manager" class="nav-link" data-scroll-target="#advanced-usage-context-manager">Advanced Usage: Context Manager</a></li>
  <li><a href="#advanced-usage-profilingconfig" id="toc-advanced-usage-profilingconfig" class="nav-link" data-scroll-target="#advanced-usage-profilingconfig">Advanced Usage: ProfilingConfig</a></li>
  <li><a href="#viewing-profiling-metrics" id="toc-viewing-profiling-metrics" class="nav-link" data-scroll-target="#viewing-profiling-metrics">Viewing Profiling Metrics</a></li>
  <li><a href="#configuration-in-axolotl-config" id="toc-configuration-in-axolotl-config" class="nav-link" data-scroll-target="#configuration-in-axolotl-config">Configuration in Axolotl Config</a></li>
  <li><a href="#performance-impact-1" id="toc-performance-impact-1" class="nav-link" data-scroll-target="#performance-impact-1">Performance Impact</a></li>
  <li><a href="#best-practices" id="toc-best-practices" class="nav-link" data-scroll-target="#best-practices">Best Practices</a></li>
  <li><a href="#example-complete-profiling-setup" id="toc-example-complete-profiling-setup" class="nav-link" data-scroll-target="#example-complete-profiling-setup">Example: Complete Profiling Setup</a></li>
  <li><a href="#troubleshooting-1" id="toc-troubleshooting-1" class="nav-link" data-scroll-target="#troubleshooting-1">Troubleshooting</a></li>
  <li><a href="#complete-config-example" id="toc-complete-config-example" class="nav-link" data-scroll-target="#complete-config-example">Complete Config Example</a></li>
  <li><a href="#modes-explained" id="toc-modes-explained" class="nav-link" data-scroll-target="#modes-explained">Modes Explained</a></li>
  <li><a href="#cloud-mode-default" id="toc-cloud-mode-default" class="nav-link" data-scroll-target="#cloud-mode-default"><code>cloud</code> Mode (Default)</a></li>
  <li><a href="#local-mode" id="toc-local-mode" class="nav-link" data-scroll-target="#local-mode"><code>local</code> Mode</a></li>
  <li><a href="#offline-mode" id="toc-offline-mode" class="nav-link" data-scroll-target="#offline-mode"><code>offline</code> Mode</a></li>
  <li><a href="#disabled-mode" id="toc-disabled-mode" class="nav-link" data-scroll-target="#disabled-mode"><code>disabled</code> Mode</a></li>
  <li><a href="#configuration-validation-conflict-detection" id="toc-configuration-validation-conflict-detection" class="nav-link" data-scroll-target="#configuration-validation-conflict-detection">Configuration Validation &amp; Conflict Detection</a></li>
  <li><a href="#required-fields-validation" id="toc-required-fields-validation" class="nav-link" data-scroll-target="#required-fields-validation">Required Fields Validation</a></li>
  <li><a href="#cloud-mode-api-key-warning" id="toc-cloud-mode-api-key-warning" class="nav-link" data-scroll-target="#cloud-mode-api-key-warning">Cloud Mode API Key Warning</a></li>
  <li><a href="#multi-logger-performance-warnings" id="toc-multi-logger-performance-warnings" class="nav-link" data-scroll-target="#multi-logger-performance-warnings">Multi-Logger Performance Warnings</a></li>
  <li><a href="#auto-enable-logic" id="toc-auto-enable-logic" class="nav-link" data-scroll-target="#auto-enable-logic">Auto-Enable Logic</a></li>
  <li><a href="#distributed-training-detection" id="toc-distributed-training-detection" class="nav-link" data-scroll-target="#distributed-training-detection">Distributed Training Detection</a></li>
  <li><a href="#authentication" id="toc-authentication" class="nav-link" data-scroll-target="#authentication">Authentication</a></li>
  <li><a href="#method-1-environment-variable-recommended" id="toc-method-1-environment-variable-recommended" class="nav-link" data-scroll-target="#method-1-environment-variable-recommended">Method 1: Environment Variable (Recommended)</a></li>
  <li><a href="#method-2-login-command" id="toc-method-2-login-command" class="nav-link" data-scroll-target="#method-2-login-command">Method 2: Login Command</a></li>
  <li><a href="#method-3-config-file" id="toc-method-3-config-file" class="nav-link" data-scroll-target="#method-3-config-file">Method 3: Config File</a></li>
  <li><a href="#what-gets-logged" id="toc-what-gets-logged" class="nav-link" data-scroll-target="#what-gets-logged">What Gets Logged?</a></li>
  <li><a href="#automatically-logged-metrics" id="toc-automatically-logged-metrics" class="nav-link" data-scroll-target="#automatically-logged-metrics">Automatically Logged Metrics</a></li>
  <li><a href="#automatically-logged-config" id="toc-automatically-logged-config" class="nav-link" data-scroll-target="#automatically-logged-config">Automatically Logged Config</a></li>
  <li><a href="#viewing-your-experiments" id="toc-viewing-your-experiments" class="nav-link" data-scroll-target="#viewing-your-experiments">Viewing Your Experiments</a></li>
  <li><a href="#cloud-mode" id="toc-cloud-mode" class="nav-link" data-scroll-target="#cloud-mode">Cloud Mode</a></li>
  <li><a href="#local-mode-1" id="toc-local-mode-1" class="nav-link" data-scroll-target="#local-mode-1">Local Mode</a></li>
  <li><a href="#integration-with-existing-tools" id="toc-integration-with-existing-tools" class="nav-link" data-scroll-target="#integration-with-existing-tools">Integration with Existing Tools</a></li>
  <li><a href="#troubleshooting-2" id="toc-troubleshooting-2" class="nav-link" data-scroll-target="#troubleshooting-2">Troubleshooting</a></li>
  <li><a href="#configuration-errors" id="toc-configuration-errors" class="nav-link" data-scroll-target="#configuration-errors">Configuration Errors</a></li>
  <li><a href="#import-errors" id="toc-import-errors" class="nav-link" data-scroll-target="#import-errors">Import Errors</a></li>
  <li><a href="#performance-issues" id="toc-performance-issues" class="nav-link" data-scroll-target="#performance-issues">Performance Issues</a></li>
  <li><a href="#distributed-training-issues" id="toc-distributed-training-issues" class="nav-link" data-scroll-target="#distributed-training-issues">Distributed Training Issues</a></li>
  <li><a href="#swanlab-not-logging-metrics" id="toc-swanlab-not-logging-metrics" class="nav-link" data-scroll-target="#swanlab-not-logging-metrics">SwanLab not logging metrics</a></li>
  <li><a href="#api-key-errors" id="toc-api-key-errors" class="nav-link" data-scroll-target="#api-key-errors">API Key errors</a></li>
  <li><a href="#cloud-sync-issues" id="toc-cloud-sync-issues" class="nav-link" data-scroll-target="#cloud-sync-issues">Cloud sync issues</a></li>
  <li><a href="#plugin-not-loaded" id="toc-plugin-not-loaded" class="nav-link" data-scroll-target="#plugin-not-loaded">Plugin not loaded</a></li>
  <li><a href="#lark-notification-issues" id="toc-lark-notification-issues" class="nav-link" data-scroll-target="#lark-notification-issues">Lark Notification Issues</a></li>
  <li><a href="#comparison-swanlab-vs-wandb" id="toc-comparison-swanlab-vs-wandb" class="nav-link" data-scroll-target="#comparison-swanlab-vs-wandb">Comparison: SwanLab vs WandB</a></li>
  <li><a href="#advanced-usage" id="toc-advanced-usage" class="nav-link" data-scroll-target="#advanced-usage">Advanced Usage</a></li>
  <li><a href="#custom-logging" id="toc-custom-logging" class="nav-link" data-scroll-target="#custom-logging">Custom Logging</a></li>
  <li><a href="#experiment-comparison" id="toc-experiment-comparison" class="nav-link" data-scroll-target="#experiment-comparison">Experiment Comparison</a></li>
  <li><a href="#support" id="toc-support" class="nav-link" data-scroll-target="#support">Support</a></li>
  <li><a href="#license" id="toc-license" class="nav-link" data-scroll-target="#license">License</a></li>
  <li><a href="#acknowledgements" id="toc-acknowledgements" class="nav-link" data-scroll-target="#acknowledgements">Acknowledgements</a></li>
  </ul></li>
  <li><a href="#adding-a-new-integration" id="toc-adding-a-new-integration" class="nav-link" data-scroll-target="#adding-a-new-integration">Adding a new integration</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../docs/fsdp_qlora.html">Advanced Features</a></li><li class="breadcrumb-item"><a href="../docs/custom_integrations.html">Custom Integrations</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Custom Integrations</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Axolotl adds custom features through <code>integrations</code>. They are located within the <code>src/axolotl/integrations</code> directory.</p>
<p>To enable them, please check the respective documentations.</p>
<section id="cut-cross-entropy" class="level2">
<h2 class="anchored" data-anchor-id="cut-cross-entropy">Cut Cross Entropy</h2>
<p>Cut Cross Entropy (CCE) reduces VRAM usage through optimization on the cross-entropy operation during loss calculation.</p>
<p>See https://github.com/apple/ml-cross-entropy</p>
<section id="requirements" class="level3">
<h3 class="anchored" data-anchor-id="requirements">Requirements</h3>
<ul>
<li>PyTorch 2.4.0 or higher</li>
</ul>
</section>
<section id="installation" class="level3">
<h3 class="anchored" data-anchor-id="installation">Installation</h3>
<p>Run the following command to install <code>cut_cross_entropy[transformers]</code> if you donâ€™t have it already.</p>
<ul>
<li>If you are in dev environment</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> scripts/cutcrossentropy_install.py <span class="kw">|</span> <span class="fu">sh</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ul>
<li>If you are installing from pip</li>
</ul>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip3</span> uninstall <span class="at">-y</span> cut-cross-entropy <span class="kw">&amp;&amp;</span> <span class="ex">pip3</span> install <span class="st">"cut-cross-entropy[transformers] @ git+https://github.com/axolotl-ai-cloud/ml-cross-entropy.git@58d6572"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="usage" class="level3">
<h3 class="anchored" data-anchor-id="usage">Usage</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.cut_cross_entropy.CutCrossEntropyPlugin</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="supported-models" class="level3">
<h3 class="anchored" data-anchor-id="supported-models">Supported Models</h3>
<ul>
<li>afmoe</li>
<li>apertus</li>
<li>arcee</li>
<li>cohere</li>
<li>cohere2</li>
<li>deepseek_v3</li>
<li>exaone4</li>
<li>gemma</li>
<li>gemma2</li>
<li>gemma3</li>
<li>gemma3_text</li>
<li>gemma3n</li>
<li>gemma3n_text</li>
<li>glm</li>
<li>glm4</li>
<li>glm4_moe</li>
<li>glm4_moe_lite</li>
<li>glm46v</li>
<li>glm4v</li>
<li>glm4v_moe</li>
<li>glm_image</li>
<li>glm_moe_dsa</li>
<li>gpt_oss</li>
<li>granite</li>
<li>granitemoe</li>
<li>granitemoehybrid</li>
<li>granitemoeshared</li>
<li>hunyuan_v1_dense</li>
<li>hunyuan_v1_moe</li>
<li>internvl</li>
<li>kimi_linear</li>
<li>lfm2</li>
<li>lfm2_moe</li>
<li>lfm2_vl</li>
<li>llama</li>
<li>llama4</li>
<li>llama4_text</li>
<li>llava</li>
<li>ministral</li>
<li>ministral3</li>
<li>mistral</li>
<li>mistral3</li>
<li>mixtral</li>
<li>mllama</li>
<li>olmo</li>
<li>olmo2</li>
<li>olmo3</li>
<li>olmoe</li>
<li>phi</li>
<li>phi3</li>
<li>phi4_multimodal</li>
<li>qwen2</li>
<li>qwen2_5_vl</li>
<li>qwen2_moe</li>
<li>qwen2_vl</li>
<li>qwen3</li>
<li>qwen3_5</li>
<li>qwen3_5_moe</li>
<li>qwen3_5_moe_vl</li>
<li>qwen3_5_vl</li>
<li>qwen3_moe</li>
<li>qwen3_next</li>
<li>qwen3_vl</li>
<li>qwen3_vl_moe</li>
<li>seed_oss</li>
<li>smollm3</li>
<li>step3p5</li>
<li>voxtral</li>
</ul>
</section>
<section id="citation" class="level3">
<h3 class="anchored" data-anchor-id="citation">Citation</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode bib code-with-copy"><code class="sourceCode bibtex"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="va">@article</span>{<span class="ot">wijmans2024cut</span>,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">author</span>       = {Erik Wijmans and</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                  Brody Huval and</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                  Alexander Hertzberg and</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                  Vladlen Koltun and</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                  Philipp Kr<span class="ch">\"</span>ahenb<span class="ch">\"</span>uhl},</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">title</span>        = {Cut Your Losses in Large-Vocabulary Language Models},</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">journal</span>      = {arXiv},</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">year</span>         = {2024},</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">url</span>          = {https://arxiv.org/abs/2411.09009},</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Please see reference <a href="https://github.com/axolotl-ai-cloud/axolotl/tree/main/src/axolotl/integrations/cut_cross_entropy">here</a></p>
</section>
</section>
<section id="densemixer" class="level2">
<h2 class="anchored" data-anchor-id="densemixer">DenseMixer</h2>
<p>See <a href="https://github.com/yaof20/DenseMixer/">DenseMixer</a></p>
<p>Simply add the following to your axolotl YAML config:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.densemixer.DenseMixerPlugin</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Please see reference <a href="https://github.com/axolotl-ai-cloud/axolotl/tree/main/src/axolotl/integrations/densemixer">here</a></p>
</section>
<section id="diffusion-lm-training-plugin-for-axolotl" class="level2">
<h2 class="anchored" data-anchor-id="diffusion-lm-training-plugin-for-axolotl">Diffusion LM Training Plugin for Axolotl</h2>
<p>This plugin enables diffusion language model training using an approach inspired by
LLaDA (Large Language Diffusion Models) within Axolotl.</p>
<section id="overview" class="level3">
<h3 class="anchored" data-anchor-id="overview">Overview</h3>
<p>LLaDA is a diffusion-based approach to language model training that uses:
- <strong>Random token masking</strong> during training instead of next-token prediction
- <strong>Bidirectional attention</strong> to allow the model to attend to the full context
- <strong>Importance weighting</strong> based on masking probabilities for stable training</p>
<p>This approach can lead to more robust language models with better understanding of
bidirectional context.</p>
</section>
<section id="installation-1" class="level3">
<h3 class="anchored" data-anchor-id="installation-1">Installation</h3>
<p>The plugin is included with Axolotl. See our
<a href="https://docs.axolotl.ai/docs/installation.html">installation docs</a>.</p>
</section>
<section id="quickstart" class="level3">
<h3 class="anchored" data-anchor-id="quickstart">Quickstart</h3>
<p>Train with an example config (Llamaâ€‘3.2 1B):
- Pretrain: <code>axolotl train examples/llama-3/diffusion-3.2-1b-pretrain.yaml</code>
- SFT: <code>axolotl train examples/llama-3/diffusion-3.2-1b-sft.yaml</code></p>
</section>
<section id="basic-configuration" class="level3">
<h3 class="anchored" data-anchor-id="basic-configuration">Basic Configuration</h3>
<p>You can also modify your existing configs to enable / customize diffusion training.</p>
<p>Add the following to your Axolotl config:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.diffusion.DiffusionPlugin</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>And, configure the nested <code>diffusion</code> block (defaults shown):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diffusion</span><span class="kw">:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">noise_schedule</span><span class="kw">:</span><span class="at"> linear</span><span class="co">  # or "cosine"</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">min_mask_ratio</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.1</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">max_mask_ratio</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.9</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">num_diffusion_steps</span><span class="kw">:</span><span class="at"> </span><span class="dv">128</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">eps</span><span class="kw">:</span><span class="at"> </span><span class="fl">1e-3</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">importance_weighting</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">  # Mask token (training auto-adds if missing, avoid pad/eos)</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">mask_token_str</span><span class="kw">:</span><span class="at"> </span><span class="st">"&lt;|diffusion_mask|&gt;"</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">  # Or use an existing special token id (e.g., 128002 for Llama-3.x)</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">  # mask_token_id: 128002</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">  # Sample generation during training (optional)</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">generate_samples</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">generation_interval</span><span class="kw">:</span><span class="at"> </span><span class="dv">100</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">num_generation_samples</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">generation_steps</span><span class="kw">:</span><span class="at"> </span><span class="dv">128</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">generation_temperature</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.0</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">generation_max_length</span><span class="kw">:</span><span class="at"> </span><span class="dv">100</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="supported-models-1" class="level3">
<h3 class="anchored" data-anchor-id="supported-models-1">Supported Models</h3>
<p>Any models that support 4D attention masks should work out of the box. If not, please
create an <a href="https://github.com/axolotl-ai-cloud/axolotl/issues">issue</a> or open a
<a href="https://github.com/axolotl-ai-cloud/axolotl/compare">PR</a>!</p>
</section>
<section id="how-it-works" class="level3">
<h3 class="anchored" data-anchor-id="how-it-works">How It Works</h3>
</section>
<section id="random-masking" class="level3">
<h3 class="anchored" data-anchor-id="random-masking">Random Masking</h3>
<p>During training, tokens are randomly masked:
- Sample timestep <code>t</code> uniformly from [0, 1]
- Calculate masking probability: <code>p = (1 - eps) * t + eps</code>
- Randomly mask tokens with probability <code>p</code></p>
</section>
<section id="diffusion-loss" class="level3">
<h3 class="anchored" data-anchor-id="diffusion-loss">Diffusion Loss</h3>
<p>Loss is computed only on masked tokens with (optional) importance weighting:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>loss <span class="op">=</span> <span class="bu">sum</span>(cross_entropy(pred, target) <span class="op">/</span> p_mask) <span class="op">/</span> total_tokens</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="sample-generation" class="level3">
<h3 class="anchored" data-anchor-id="sample-generation">Sample Generation</h3>
<p>When <code>diffusion.generate_samples: true</code>, the plugin generates samples during training:</p>
<pre><code>Sample 1:
   Original (45 tokens): The quick brown fox jumps over the lazy dog...
   Masked (18/45 tokens, 40.0%): The [MASK] [MASK] fox [MASK] over [MASK] lazy [MASK]...
   Generated: The quick brown fox jumps over the lazy dog...</code></pre>
<p>Samples are logged to console and wandb (if enabled).</p>
</section>
<section id="inference" class="level3">
<h3 class="anchored" data-anchor-id="inference">Inference</h3>
<p>Diffusion inference is integrated into the standard Axolotl CLI. Use the same config
you trained with and run:</p>
<pre><code>axolotl inference path/to/your-config.yaml</code></pre>
<p>Optionally, pass <code>--gradio</code> to use a simple web interface.</p>
<p>Interactive controls (prefix the prompt with commands):
- <code>:complete N</code> â†’ completion mode with N new masked tokens appended (default 64)
- <code>:mask R</code> â†’ random masking mode with target mask ratio R in [0.0, 1.0]</p>
<p>Example session:</p>
<pre><code>================================================================================
Commands:
:complete N -&gt; completion mode with N tokens (default 64)
:mask R     -&gt; random masking with ratio R (0.0â€“1.0)
================================================================================
Give me an instruction (Ctrl + D to submit):

:mask 0.4 The quick brown fox jumps over the lazy dog

Masked (40.0%):
The [MASK] brown [MASK] jumps over the [MASK] dog

Generated:
The quick brown fox jumps over the loud dog</code></pre>
</section>
<section id="metrics-and-monitoring" class="level3">
<h3 class="anchored" data-anchor-id="metrics-and-monitoring">Metrics and Monitoring</h3>
<p>The plugin adds (or modifies) several metrics to track diffusion training:</p>
<ul>
<li><code>train/loss</code>: Weighted diffusion loss</li>
<li><code>train/accuracy</code>: Accuracy on masked tokens</li>
<li><code>train/mask_ratio</code>: Average fraction of tokens masked</li>
<li><code>train/num_masked_tokens</code>: Number of tokens masked</li>
<li><code>train/avg_p_mask</code>: Average masking probability</li>
<li><code>train/ce_loss</code>: Unweighted cross-entropy loss</li>
<li><code>train/importance_weight_avg</code>: Average importance weight</li>
</ul>
</section>
<section id="limitations" class="level3">
<h3 class="anchored" data-anchor-id="limitations">Limitations</h3>
<ul>
<li>No flash attention support</li>
<li>No RL training support</li>
</ul>
</section>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>
<ul>
<li><a href="https://arxiv.org/abs/2404.10406">LLaDA Paper</a></li>
<li><a href="https://docs.axolotl.ai/">Axolotl Documentation</a></li>
<li><a href="https://docs.axolotl.ai/docs/api/integrations.diffusion.args.html#axolotl.integrations.diffusion.args">API reference for plugin</a></li>
</ul>
<p>Please see reference <a href="https://github.com/axolotl-ai-cloud/axolotl/tree/main/src/axolotl/integrations/diffusion">here</a></p>
</section>
</section>
<section id="grokfast" class="level2">
<h2 class="anchored" data-anchor-id="grokfast">Grokfast</h2>
<p>See https://github.com/ironjr/grokfast</p>
<section id="usage-1" class="level3">
<h3 class="anchored" data-anchor-id="usage-1">Usage</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.grokfast.GrokfastPlugin</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">grokfast_alpha</span><span class="kw">:</span><span class="at"> </span><span class="fl">2.0</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">grokfast_lamb</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.98</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="citation-1" class="level3">
<h3 class="anchored" data-anchor-id="citation-1">Citation</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="sourceCode bib code-with-copy"><code class="sourceCode bibtex"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="va">@article</span>{<span class="ot">lee2024grokfast</span>,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">title</span>={{Grokfast}: Accelerated Grokking by Amplifying Slow Gradients},</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">author</span>={Lee, Jaerin and Kang, Bong Gyun and Kim, Kihoon and Lee, Kyoung Mu},</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">journal</span>={arXiv preprint arXiv:2405.20233},</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">year</span>={2024}</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Please see reference <a href="https://github.com/axolotl-ai-cloud/axolotl/tree/main/src/axolotl/integrations/grokfast">here</a></p>
</section>
</section>
<section id="kernels-integration" class="level2">
<h2 class="anchored" data-anchor-id="kernels-integration">Kernels Integration</h2>
<p>MoE (Mixture of Experts) kernels speed up training for MoE layers and reduce VRAM costs. In transformers v5, <code>batched_mm</code> and <code>grouped_mm</code> were integrated as built-in options via the <code>experts_implementation</code> config kwarg:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> ExpertsInterface(GeneralInterface):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    _global_mapping <span class="op">=</span> {</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"batched_mm"</span>: batched_mm_experts_forward,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"grouped_mm"</span>: grouped_mm_experts_forward,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>In our custom integration, we add support for <strong>ScatterMoE</strong>, which is even more efficient and faster than <code>grouped_mm</code>.</p>
<section id="usage-2" class="level3">
<h3 class="anchored" data-anchor-id="usage-2">Usage</h3>
<p>Add the following to your axolotl YAML config:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.kernels.KernelsPlugin</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">use_kernels</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">use_scattermoe</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Important:</strong> Setting <code>experts_implementation</code> is incompatible with <code>use_scattermoe</code>.</p>
</section>
<section id="how-it-works-1" class="level3">
<h3 class="anchored" data-anchor-id="how-it-works-1">How It Works</h3>
<p>The <code>KernelsPlugin</code> runs before model loading and:</p>
<ol type="1">
<li>Registers the ScatterMoE kernel from the <a href="https://huggingface.co/axolotl-ai-co/scattermoe"><code>axolotl-ai-co/scattermoe</code></a> Hub repo.</li>
<li>Patches the modelâ€™s <code>SparseMoeBlock</code> forward method with the optimized ScatterMoE implementation.</li>
</ol>
<p>This works for any MoE model in transformers that uses a <code>SparseMoeBlock</code> class (Mixtral, Qwen2-MoE, OLMoE, etc.).</p>
</section>
<section id="limitations-1" class="level3">
<h3 class="anchored" data-anchor-id="limitations-1">Limitations</h3>
<p>ScatterMoE uses a softmax -&gt; topk routing, so results may be different for some model arch as baseline (GPT-OSS, GLM_MOE_DSA).</p>
</section>
<section id="note-on-megablocks" class="level3">
<h3 class="anchored" data-anchor-id="note-on-megablocks">Note on MegaBlocks</h3>
<p>We tested <a href="https://huggingface.co/kernels-community/megablocks">MegaBlocks</a> but were unable to ensure numerical accuracy, so we did not integrate it. It was also incompatible with many newer model architectures in transformers.</p>
<p>Please see reference <a href="https://github.com/axolotl-ai-cloud/axolotl/tree/main/src/axolotl/integrations/kernels">here</a></p>
</section>
</section>
<section id="knowledge-distillation-kd" class="level2">
<h2 class="anchored" data-anchor-id="knowledge-distillation-kd">Knowledge Distillation (KD)</h2>
<section id="usage-3" class="level3">
<h3 class="anchored" data-anchor-id="usage-3">Usage</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="st">"axolotl.integrations.kd.KDPlugin"</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kd_trainer</span><span class="kw">:</span><span class="at"> </span><span class="ch">True</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kd_ce_alpha</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.1</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kd_alpha</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.9</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kd_temperature</span><span class="kw">:</span><span class="at"> </span><span class="fl">1.0</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">torch_compile</span><span class="kw">:</span><span class="at"> </span><span class="ch">True</span><span class="co">  # torch&gt;=2.6.0, recommended to reduce vram</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">datasets</span><span class="kw">:</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">path</span><span class="kw">:</span><span class="at"> ...</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> </span><span class="st">"axolotl.integrations.kd.chat_template"</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">field_messages</span><span class="kw">:</span><span class="at"> </span><span class="st">"messages_combined"</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">logprobs_field</span><span class="kw">:</span><span class="at"> </span><span class="st">"llm_text_generation_vllm_logprobs"</span><span class="co">  # for kd only, field of logprobs</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>An example dataset can be found at <a href="https://huggingface.co/datasets/axolotl-ai-co/evolkit-logprobs-pipeline-75k-v2-sample"><code>axolotl-ai-co/evolkit-logprobs-pipeline-75k-v2-sample</code></a></p>
<p>Please see reference <a href="https://github.com/axolotl-ai-cloud/axolotl/tree/main/src/axolotl/integrations/kd">here</a></p>
</section>
</section>
<section id="llmcompressor" class="level2">
<h2 class="anchored" data-anchor-id="llmcompressor">LLMCompressor</h2>
<p>Fine-tune sparsified models in Axolotl using Neural Magicâ€™s <a href="https://github.com/vllm-project/llm-compressor">LLMCompressor</a>.</p>
<p>This integration enables fine-tuning of models sparsified using LLMCompressor within the Axolotl training framework. By combining LLMCompressorâ€™s model compression capabilities with Axolotlâ€™s distributed training pipelines, users can efficiently fine-tune sparse models at scale.</p>
<p>It uses Axolotlâ€™s plugin system to hook into the fine-tuning flows while maintaining sparsity throughout training.</p>
<hr>
<section id="requirements-1" class="level3">
<h3 class="anchored" data-anchor-id="requirements-1">Requirements</h3>
<ul>
<li><p>Axolotl with <code>llmcompressor</code> extras:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="st">"axolotl[llmcompressor]"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p>Requires <code>llmcompressor &gt;= 0.5.1</code></p></li>
</ul>
<p>This will install all necessary dependencies to fine-tune sparsified models using the integration.</p>
<hr>
</section>
<section id="usage-4" class="level3">
<h3 class="anchored" data-anchor-id="usage-4">Usage</h3>
<p>To enable sparse fine-tuning with this integration, include the plugin in your Axolotl config:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.llm_compressor.LLMCompressorPlugin</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">llmcompressor</span><span class="kw">:</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">recipe</span><span class="kw">:</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">finetuning_stage</span><span class="kw">:</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">finetuning_modifiers</span><span class="kw">:</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">ConstantPruningModifier</span><span class="kw">:</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">targets</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="st">'re:.*q_proj.weight'</span><span class="kw">,</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="st">'re:.*k_proj.weight'</span><span class="kw">,</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="st">'re:.*v_proj.weight'</span><span class="kw">,</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="st">'re:.*o_proj.weight'</span><span class="kw">,</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="st">'re:.*gate_proj.weight'</span><span class="kw">,</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="st">'re:.*up_proj.weight'</span><span class="kw">,</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="at">            </span><span class="st">'re:.*down_proj.weight'</span><span class="kw">,</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="kw">]</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">start</span><span class="kw">:</span><span class="at"> </span><span class="dv">0</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">save_compressed</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This plugin <strong>does not apply pruning or sparsification itself</strong> â€” it is intended for <strong>fine-tuning models that have already been sparsified</strong>.</p>
<p>Pre-sparsified checkpoints can be:
- Generated using <a href="https://github.com/vllm-project/llm-compressor">LLMCompressor</a>
- Downloaded from <a href="https://huggingface.co/neuralmagic">Neural Magicâ€™s Hugging Face page</a>
- Any custom LLM with compatible sparsity patterns that youâ€™ve created yourself</p>
<p>To learn more about writing and customizing LLMCompressor recipes, refer to the official documentation:
<a href="https://github.com/vllm-project/llm-compressor/blob/main/README.md">https://github.com/vllm-project/llm-compressor/blob/main/README.md</a></p>
</section>
<section id="storage-optimization-with-save_compressed" class="level3">
<h3 class="anchored" data-anchor-id="storage-optimization-with-save_compressed">Storage Optimization with save_compressed</h3>
<p>Setting <code>save_compressed: true</code> in your configuration enables saving models in a compressed format, which:
- Reduces disk space usage by approximately 40%
- Maintains compatibility with vLLM for accelerated inference
- Maintains compatibility with llmcompressor for further optimization (example: quantization)</p>
<p>This option is highly recommended when working with sparse models to maximize the benefits of model compression.</p>
</section>
<section id="example-config" class="level3">
<h3 class="anchored" data-anchor-id="example-config">Example Config</h3>
<p>See <a href="examples/llama-3/sparse-finetuning.yaml"><code>examples/llama-3/sparse-finetuning.yaml</code></a> for a complete example.</p>
<hr>
</section>
<section id="inference-with-vllm" class="level3">
<h3 class="anchored" data-anchor-id="inference-with-vllm">Inference with vLLM</h3>
<p>After fine-tuning your sparse model, you can leverage vLLM for efficient inference.
You can also use LLMCompressor to apply additional quantization to your fine-tuned
sparse model before inference for even greater performance benefits.:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> vllm <span class="im">import</span> LLM, SamplingParams</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>prompts <span class="op">=</span> [</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Hello, my name is"</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The president of the United States is"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The capital of France is"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The future of AI is"</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>sampling_params <span class="op">=</span> SamplingParams(temperature<span class="op">=</span><span class="fl">0.8</span>, top_p<span class="op">=</span><span class="fl">0.95</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>llm <span class="op">=</span> LLM(<span class="st">"path/to/your/sparse/model"</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>outputs <span class="op">=</span> llm.generate(prompts, sampling_params)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> output <span class="kw">in</span> outputs:</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    prompt <span class="op">=</span> output.prompt</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    generated_text <span class="op">=</span> output.outputs[<span class="dv">0</span>].text</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Prompt: </span><span class="sc">{</span>prompt<span class="sc">!r}</span><span class="ss">, Generated text: </span><span class="sc">{</span>generated_text<span class="sc">!r}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>For more details on vLLMâ€™s capabilities and advanced configuration options, see the <a href="https://docs.vllm.ai/">official vLLM documentation</a>.</p>
</section>
<section id="learn-more" class="level3">
<h3 class="anchored" data-anchor-id="learn-more">Learn More</h3>
<p>For details on available sparsity and quantization schemes, fine-tuning recipes, and usage examples, visit the official LLMCompressor repository:</p>
<p><a href="https://github.com/vllm-project/llm-compressor">https://github.com/vllm-project/llm-compressor</a></p>
<p>Please see reference <a href="https://github.com/axolotl-ai-cloud/axolotl/tree/main/src/axolotl/integrations/llm_compressor">here</a></p>
</section>
</section>
<section id="language-model-evaluation-harness-lm-eval" class="level2">
<h2 class="anchored" data-anchor-id="language-model-evaluation-harness-lm-eval">Language Model Evaluation Harness (LM Eval)</h2>
<p>Run evaluation on model using the popular lm-evaluation-harness library.</p>
<p>See https://github.com/EleutherAI/lm-evaluation-harness</p>
<section id="usage-5" class="level3">
<h3 class="anchored" data-anchor-id="usage-5">Usage</h3>
<p>There are two ways to use the LM Eval integration:</p>
</section>
<section id="post-training-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="post-training-evaluation">1. Post-Training Evaluation</h3>
<p>When training with the plugin enabled, evaluation runs automatically after training completes:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.lm_eval.LMEvalPlugin</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lm_eval_tasks</span><span class="kw">:</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> gsm8k</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> hellaswag</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> arc_easy</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lm_eval_batch_size</span><span class="kw">:</span><span class="co"> # Batch size for evaluation</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">output_dir</span><span class="kw">:</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Run training as usual:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="ex">axolotl</span> train config.yml</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="standalone-cli-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="standalone-cli-evaluation">2. Standalone CLI Evaluation</h3>
<p>Evaluate any model directly without training:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm_eval_model</span><span class="kw">:</span><span class="at"> meta-llama/Llama-2-7b-hf</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.lm_eval.LMEvalPlugin</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lm_eval_tasks</span><span class="kw">:</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> gsm8k</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> hellaswag</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> arc_easy</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lm_eval_batch_size</span><span class="kw">:</span><span class="at"> </span><span class="dv">8</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="fu">output_dir</span><span class="kw">:</span><span class="at"> ./outputs</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Run evaluation:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ex">axolotl</span> lm-eval config.yml</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="model-selection-priority" class="level3">
<h3 class="anchored" data-anchor-id="model-selection-priority">Model Selection Priority</h3>
<p>The model to evaluate is selected in the following priority order:</p>
<ol type="1">
<li><strong><code>lm_eval_model</code></strong> - Explicit model path or HuggingFace repo (highest priority)</li>
<li><strong><code>hub_model_id</code></strong> - Trained model pushed to HuggingFace Hub</li>
<li><strong><code>output_dir</code></strong> - Local checkpoint directory containing trained model weights</li>
</ol>
</section>
<section id="citation-2" class="level3">
<h3 class="anchored" data-anchor-id="citation-2">Citation</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="sourceCode bib code-with-copy"><code class="sourceCode bibtex"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="va">@misc</span>{<span class="ot">eval</span>-<span class="ot">harness</span>,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">author</span>       = {Gao, Leo and Tow, Jonathan and Abbasi, Baber and Biderman, Stella and Black, Sid and DiPofi, Anthony and Foster, Charles and Golding, Laurence and Hsu, Jeffrey and Le Noac'h, Alain and Li, Haonan and McDonell, Kyle and Muennighoff, Niklas and Ociepa, Chris and Phang, Jason and Reynolds, Laria and Schoelkopf, Hailey and Skowron, Aviya and Sutawika, Lintang and Tang, Eric and Thite, Anish and Wang, Ben and Wang, Kevin and Zou, Andy},</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">title</span>        = {A framework for few-shot language model evaluation},</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">month</span>        = 07,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">year</span>         = 2024,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">publisher</span>    = {Zenodo},</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">version</span>      = {v0.4.3},</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">doi</span>          = {10.5281/zenodo.12608602},</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">url</span>          = {https://zenodo.org/records/12608602}</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Please see reference <a href="https://github.com/axolotl-ai-cloud/axolotl/tree/main/src/axolotl/integrations/lm_eval">here</a></p>
</section>
</section>
<section id="liger-kernels" class="level2">
<h2 class="anchored" data-anchor-id="liger-kernels">Liger Kernels</h2>
<p>Liger Kernel provides efficient Triton kernels for LLM training, offering:</p>
<ul>
<li>20% increase in multi-GPU training throughput</li>
<li>60% reduction in memory usage</li>
<li>Compatibility with both FSDP and DeepSpeed</li>
</ul>
<p>See https://github.com/linkedin/Liger-Kernel</p>
<section id="usage-6" class="level3">
<h3 class="anchored" data-anchor-id="usage-6">Usage</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.liger.LigerPlugin</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">liger_rope</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">liger_rms_norm</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">liger_glu_activation</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">liger_layer_norm</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">liger_fused_linear_cross_entropy</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">liger_use_token_scaling</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="supported-models-2" class="level3">
<h3 class="anchored" data-anchor-id="supported-models-2">Supported Models</h3>
<ul>
<li>deepseek_v2</li>
<li>gemma</li>
<li>gemma2</li>
<li>gemma3</li>
<li>granite</li>
<li>jamba</li>
<li>llama</li>
<li>mistral</li>
<li>mixtral</li>
<li>mllama</li>
<li>mllama_text_model</li>
<li>olmo2</li>
<li>paligemma</li>
<li>phi3</li>
<li>qwen2</li>
<li>qwen2_5_vl</li>
<li>qwen2_vl</li>
</ul>
</section>
<section id="citation-3" class="level3">
<h3 class="anchored" data-anchor-id="citation-3">Citation</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="sourceCode bib code-with-copy"><code class="sourceCode bibtex"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="va">@article</span>{<span class="ot">hsu2024ligerkernelefficienttriton</span>,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>      <span class="dt">title</span>={Liger Kernel: Efficient Triton Kernels for LLM Training},</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>      <span class="dt">author</span>={Pin-Lun Hsu and Yun Dai and Vignesh Kothapalli and Qingquan Song and Shao Tang and Siyu Zhu and Steven Shimizu and Shivam Sahni and Haowen Ning and Yanning Chen},</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">year</span>={2024},</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">eprint</span>={2410.10989},</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">archivePrefix</span>={arXiv},</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">primaryClass</span>={cs.LG},</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>      <span class="dt">url</span>={https://arxiv.org/abs/2410.10989},</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>      <span class="dt">journal</span>={arXiv preprint arXiv:2410.10989},</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Please see reference <a href="https://github.com/axolotl-ai-cloud/axolotl/tree/main/src/axolotl/integrations/liger">here</a></p>
</section>
</section>
<section id="spectrum" class="level2">
<h2 class="anchored" data-anchor-id="spectrum">Spectrum</h2>
<p>by Eric Hartford, Lucas Atkins, Fernando Fernandes, David Golchinfar</p>
<p>This plugin contains code to freeze the bottom fraction of modules in a model, based on the Signal-to-Noise Ratio (SNR).</p>
<p>See https://github.com/cognitivecomputations/spectrum</p>
<section id="overview-1" class="level3">
<h3 class="anchored" data-anchor-id="overview-1">Overview</h3>
<p>Spectrum is a tool for scanning and evaluating the Signal-to-Noise Ratio (SNR) of layers in large language models.
By identifying the top n% of layers with the highest SNR, you can optimize training efficiency.</p>
</section>
<section id="usage-7" class="level3">
<h3 class="anchored" data-anchor-id="usage-7">Usage</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.spectrum.SpectrumPlugin</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">spectrum_top_fraction</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.5</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spectrum_model_name</span><span class="kw">:</span><span class="at"> meta-llama/Meta-Llama-3.1-8B</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="citation-4" class="level3">
<h3 class="anchored" data-anchor-id="citation-4">Citation</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="sourceCode bib code-with-copy"><code class="sourceCode bibtex"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="va">@misc</span>{<span class="ot">hartford2024spectrumtargetedtrainingsignal</span>,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>      <span class="dt">title</span>={Spectrum: Targeted Training on Signal to Noise Ratio},</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>      <span class="dt">author</span>={Eric Hartford and Lucas Atkins and Fernando Fernandes Neto and David Golchinfar},</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">year</span>={2024},</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">eprint</span>={2406.06623},</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">archivePrefix</span>={arXiv},</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">primaryClass</span>={cs.LG},</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>      <span class="dt">url</span>={https://arxiv.org/abs/2406.06623},</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Please see reference <a href="https://github.com/axolotl-ai-cloud/axolotl/tree/main/src/axolotl/integrations/spectrum">here</a></p>
</section>
</section>
<section id="swanlab-integration-for-axolotl" class="level2">
<h2 class="anchored" data-anchor-id="swanlab-integration-for-axolotl">SwanLab Integration for Axolotl</h2>
<p>SwanLab is an open-source, lightweight AI experiment tracking and visualization tool that provides a platform for tracking, recording, comparing, and collaborating on experiments.</p>
<p>This integration enables seamless experiment tracking and visualization of Axolotl training runs using SwanLab.</p>
<section id="features" class="level3">
<h3 class="anchored" data-anchor-id="features">Features</h3>
<ul>
<li>ðŸ“Š <strong>Automatic Metrics Logging</strong>: Training loss, learning rate, and other metrics are automatically logged</li>
<li>ðŸŽ¯ <strong>Hyperparameter Tracking</strong>: Model configuration and training parameters are tracked</li>
<li>ðŸ“ˆ <strong>Real-time Visualization</strong>: Monitor training progress in real-time through SwanLab dashboard</li>
<li>â˜ï¸ <strong>Cloud &amp; Local Support</strong>: Works in both cloud-synced and offline modes</li>
<li>ðŸ”„ <strong>Experiment Comparison</strong>: Compare multiple training runs easily</li>
<li>ðŸ¤ <strong>Team Collaboration</strong>: Share experiments with team members</li>
<li>ðŸŽ­ <strong>RLHF Completion Logging</strong>: Automatically log model outputs during DPO/KTO/ORPO/GRPO training for qualitative analysis</li>
<li>âš¡ <strong>Performance Profiling</strong>: Built-in profiling decorators to measure and optimize training performance</li>
<li>ðŸ”” <strong>Lark Notifications</strong>: Send real-time training updates to team chat (Feishu/Lark integration)</li>
</ul>
</section>
<section id="installation-2" class="level3">
<h3 class="anchored" data-anchor-id="installation-2">Installation</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install swanlab</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="quick-start" class="level3">
<h3 class="anchored" data-anchor-id="quick-start">Quick Start</h3>
</section>
<section id="register-for-swanlab-optional-for-cloud-mode" class="level3">
<h3 class="anchored" data-anchor-id="register-for-swanlab-optional-for-cloud-mode">1. Register for SwanLab (Optional for cloud mode)</h3>
<p>If you want to use cloud sync features, register at <a href="https://swanlab.cn">https://swanlab.cn</a> to get your API key.</p>
</section>
<section id="configure-axolotl-config-file" class="level3">
<h3 class="anchored" data-anchor-id="configure-axolotl-config-file">2. Configure Axolotl Config File</h3>
<p>Add SwanLab configuration to your Axolotl YAML config:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb30"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.swanlab.SwanLabPlugin</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-llm-project</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_experiment_name</span><span class="kw">:</span><span class="at"> qwen-finetune-v1</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_mode</span><span class="kw">:</span><span class="at"> cloud</span><span class="co">  # Options: cloud, local, offline, disabled</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_workspace</span><span class="kw">:</span><span class="at"> my-team</span><span class="co">  # Optional: organization name</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_api_key</span><span class="kw">:</span><span class="at"> YOUR_API_KEY</span><span class="co">  # Optional: can also use env var SWANLAB_API_KEY</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="run-training" class="level3">
<h3 class="anchored" data-anchor-id="run-training">3. Run Training</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">SWANLAB_API_KEY</span><span class="op">=</span>your-api-key-here</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="ex">swanlab</span> login</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="ex">accelerate</span> launch <span class="at">-m</span> axolotl.cli.train your-config.yaml</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="configuration-options" class="level3">
<h3 class="anchored" data-anchor-id="configuration-options">Configuration Options</h3>
</section>
<section id="basic-configuration-1" class="level3">
<h3 class="anchored" data-anchor-id="basic-configuration-1">Basic Configuration</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 15%">
<col style="width: 23%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>use_swanlab</code></td>
<td>bool</td>
<td><code>false</code></td>
<td>Enable SwanLab tracking</td>
</tr>
<tr class="even">
<td><code>swanlab_project</code></td>
<td>str</td>
<td><code>None</code></td>
<td>Project name (required)</td>
</tr>
<tr class="odd">
<td><code>swanlab_experiment_name</code></td>
<td>str</td>
<td><code>None</code></td>
<td>Experiment name</td>
</tr>
<tr class="even">
<td><code>swanlab_description</code></td>
<td>str</td>
<td><code>None</code></td>
<td>Experiment description</td>
</tr>
<tr class="odd">
<td><code>swanlab_mode</code></td>
<td>str</td>
<td><code>cloud</code></td>
<td>Sync mode: <code>cloud</code>, <code>local</code>, <code>offline</code>, <code>disabled</code></td>
</tr>
</tbody>
</table>
</section>
<section id="advanced-configuration" class="level3">
<h3 class="anchored" data-anchor-id="advanced-configuration">Advanced Configuration</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 15%">
<col style="width: 23%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>swanlab_workspace</code></td>
<td>str</td>
<td><code>None</code></td>
<td>Workspace/organization name</td>
</tr>
<tr class="even">
<td><code>swanlab_api_key</code></td>
<td>str</td>
<td><code>None</code></td>
<td>API key (prefer env var)</td>
</tr>
<tr class="odd">
<td><code>swanlab_web_host</code></td>
<td>str</td>
<td><code>None</code></td>
<td>Private deployment web host</td>
</tr>
<tr class="even">
<td><code>swanlab_api_host</code></td>
<td>str</td>
<td><code>None</code></td>
<td>Private deployment API host</td>
</tr>
<tr class="odd">
<td><code>swanlab_log_model</code></td>
<td>bool</td>
<td><code>false</code></td>
<td>Log model checkpoints (coming soon)</td>
</tr>
<tr class="even">
<td><code>swanlab_lark_webhook_url</code></td>
<td>str</td>
<td><code>None</code></td>
<td>Lark (Feishu) webhook URL for team notifications</td>
</tr>
<tr class="odd">
<td><code>swanlab_lark_secret</code></td>
<td>str</td>
<td><code>None</code></td>
<td>Lark webhook HMAC secret for authentication</td>
</tr>
<tr class="even">
<td><code>swanlab_log_completions</code></td>
<td>bool</td>
<td><code>true</code></td>
<td>Enable RLHF completion table logging (DPO/KTO/ORPO/GRPO)</td>
</tr>
<tr class="odd">
<td><code>swanlab_completion_log_interval</code></td>
<td>int</td>
<td><code>100</code></td>
<td>Steps between completion logging</td>
</tr>
<tr class="even">
<td><code>swanlab_completion_max_buffer</code></td>
<td>int</td>
<td><code>128</code></td>
<td>Max completions to buffer (memory bound)</td>
</tr>
</tbody>
</table>
</section>
<section id="configuration-examples" class="level3">
<h3 class="anchored" data-anchor-id="configuration-examples">Configuration Examples</h3>
</section>
<section id="example-1-basic-cloud-sync" class="level3">
<h3 class="anchored" data-anchor-id="example-1-basic-cloud-sync">Example 1: Basic Cloud Sync</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.swanlab.SwanLabPlugin</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> llama-finetune</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_experiment_name</span><span class="kw">:</span><span class="at"> llama-3-8b-instruct-v1</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_mode</span><span class="kw">:</span><span class="at"> cloud</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="example-2-offlinelocal-mode" class="level3">
<h3 class="anchored" data-anchor-id="example-2-offlinelocal-mode">Example 2: Offline/Local Mode</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.swanlab.SwanLabPlugin</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> local-experiments</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_experiment_name</span><span class="kw">:</span><span class="at"> test-run-1</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_mode</span><span class="kw">:</span><span class="at"> local</span><span class="co">  # or 'offline'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="example-3-team-workspace" class="level3">
<h3 class="anchored" data-anchor-id="example-3-team-workspace">Example 3: Team Workspace</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb34"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.swanlab.SwanLabPlugin</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> research-project</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_experiment_name</span><span class="kw">:</span><span class="at"> experiment-42</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_workspace</span><span class="kw">:</span><span class="at"> my-research-team</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_mode</span><span class="kw">:</span><span class="at"> cloud</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="example-4-private-deployment" class="level3">
<h3 class="anchored" data-anchor-id="example-4-private-deployment">Example 4: Private Deployment</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb35"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.swanlab.SwanLabPlugin</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> internal-project</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_experiment_name</span><span class="kw">:</span><span class="at"> secure-training</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_mode</span><span class="kw">:</span><span class="at"> cloud</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_web_host</span><span class="kw">:</span><span class="at"> https://swanlab.yourcompany.com</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_api_host</span><span class="kw">:</span><span class="at"> https://api.swanlab.yourcompany.com</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="team-notifications-with-lark-feishu" class="level3">
<h3 class="anchored" data-anchor-id="team-notifications-with-lark-feishu">Team Notifications with Lark (Feishu)</h3>
<p>SwanLab supports sending real-time training notifications to your team chat via Lark (Feishu), ByteDanceâ€™s enterprise collaboration platform. This is especially useful for:
- <strong>Production training monitoring</strong>: Get alerts when training starts, completes, or encounters errors
- <strong>Team collaboration</strong>: Keep your ML team informed about long-running experiments
- <strong>Multi-timezone teams</strong>: Team members can check training progress without being online</p>
</section>
<section id="prerequisites" class="level3">
<h3 class="anchored" data-anchor-id="prerequisites">Prerequisites</h3>
<ol type="1">
<li><strong>Lark Bot Setup</strong>: Create a custom bot in your Lark group chat</li>
<li><strong>Webhook URL</strong>: Get the webhook URL from your Lark bot settings</li>
<li><strong>HMAC Secret</strong> (recommended): Enable signature verification in your Lark bot for security</li>
</ol>
<p>For detailed Lark bot setup instructions, see <a href="https://open.feishu.cn/document/ukTMukTMukTM/ucTM5YjL3ETO24yNxkjN">Lark Custom Bot Documentation</a>.</p>
</section>
<section id="example-5-basic-lark-notifications" class="level3">
<h3 class="anchored" data-anchor-id="example-5-basic-lark-notifications">Example 5: Basic Lark Notifications</h3>
<p>Send training notifications to a Lark group chat:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb36"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.swanlab.SwanLabPlugin</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> production-training</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_experiment_name</span><span class="kw">:</span><span class="at"> llama-3-finetune-v2</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_mode</span><span class="kw">:</span><span class="at"> cloud</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_lark_webhook_url</span><span class="kw">:</span><span class="at"> https://open.feishu.cn/open-apis/bot/v2/hook/xxxxxxxxxx</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Note</strong>: This configuration will work, but youâ€™ll see a security warning recommending HMAC secret configuration.</p>
</section>
<section id="example-6-lark-notifications-with-hmac-security-recommended" class="level3">
<h3 class="anchored" data-anchor-id="example-6-lark-notifications-with-hmac-security-recommended">Example 6: Lark Notifications with HMAC Security (Recommended)</h3>
<p>For production use, enable HMAC signature verification:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb37"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.swanlab.SwanLabPlugin</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> production-training</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_experiment_name</span><span class="kw">:</span><span class="at"> llama-3-finetune-v2</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_mode</span><span class="kw">:</span><span class="at"> cloud</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_lark_webhook_url</span><span class="kw">:</span><span class="at"> https://open.feishu.cn/open-apis/bot/v2/hook/xxxxxxxxxx</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_lark_secret</span><span class="kw">:</span><span class="at"> your-webhook-secret-key</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Why HMAC secret matters</strong>:
- Prevents unauthorized parties from sending fake notifications to your Lark group
- Ensures notifications genuinely come from your training jobs
- Required for production deployments with sensitive training data</p>
</section>
<section id="example-7-team-workspace-lark-notifications" class="level3">
<h3 class="anchored" data-anchor-id="example-7-team-workspace-lark-notifications">Example 7: Team Workspace + Lark Notifications</h3>
<p>Combine team workspace collaboration with Lark notifications:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb38"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.swanlab.SwanLabPlugin</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> research-project</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_experiment_name</span><span class="kw">:</span><span class="at"> multimodal-experiment-42</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_workspace</span><span class="kw">:</span><span class="at"> ml-research-team</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_mode</span><span class="kw">:</span><span class="at"> cloud</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_lark_webhook_url</span><span class="kw">:</span><span class="at"> https://open.feishu.cn/open-apis/bot/v2/hook/xxxxxxxxxx</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_lark_secret</span><span class="kw">:</span><span class="at"> your-webhook-secret-key</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="what-notifications-are-sent" class="level3">
<h3 class="anchored" data-anchor-id="what-notifications-are-sent">What Notifications Are Sent?</h3>
<p>SwanLabâ€™s Lark integration sends notifications for key training events:
- <strong>Training Start</strong>: When your experiment begins
- <strong>Training Complete</strong>: When training finishes successfully
- <strong>Training Errors</strong>: If training crashes or encounters critical errors
- <strong>Metric Milestones</strong>: Configurable alerts for metric thresholds (if configured in SwanLab)</p>
<p>Each notification includes:
- Experiment name and project
- Training status
- Key metrics (loss, learning rate)
- Direct link to SwanLab dashboard</p>
</section>
<section id="lark-configuration-validation" class="level3">
<h3 class="anchored" data-anchor-id="lark-configuration-validation">Lark Configuration Validation</h3>
<p>The plugin validates your Lark configuration at startup:</p>
<section id="valid-configurations" class="level4">
<h4 class="anchored" data-anchor-id="valid-configurations">âœ… Valid Configurations</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb39"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_lark_webhook_url</span><span class="kw">:</span><span class="at"> https://open.feishu.cn/open-apis/bot/v2/hook/xxx</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_lark_secret</span><span class="kw">:</span><span class="at"> your-secret</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_lark_webhook_url</span><span class="kw">:</span><span class="at"> https://open.feishu.cn/open-apis/bot/v2/hook/xxx</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="security-best-practices" class="level3">
<h3 class="anchored" data-anchor-id="security-best-practices">Security Best Practices</h3>
<ol type="1">
<li><p><strong>Always use HMAC secret in production</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb40"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_lark_webhook_url</span><span class="kw">:</span><span class="at"> https://open.feishu.cn/...</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_lark_secret</span><span class="kw">:</span><span class="at"> your-secret-key</span><span class="co">  # âœ… Add this!</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p><strong>Store secrets in environment variables</strong> (even better):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb41"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In your training script/environment</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="at">export SWANLAB_LARK_WEBHOOK_URL="https://open.feishu.cn/..."</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="at">export SWANLAB_LARK_SECRET="your-secret-key"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Then in config:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb42"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SwanLab plugin will auto-detect environment variables</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Lark URL and secret read from env vars</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p><strong>Rotate webhook secrets periodically</strong>: Update your Lark botâ€™s secret every 90 days</p></li>
<li><p><strong>Use separate webhooks for dev/prod</strong>: Donâ€™t mix development and production notifications</p></li>
</ol>
</section>
<section id="distributed-training" class="level3">
<h3 class="anchored" data-anchor-id="distributed-training">Distributed Training</h3>
<p>Lark notifications are automatically deduplicated in distributed training:
- Only <strong>rank 0</strong> sends notifications
- Other GPU ranks skip Lark registration
- Prevents duplicate messages in multi-GPU training</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb43"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="ex">torchrun</span> <span class="at">--nproc_per_node</span><span class="op">=</span>4 <span class="at">-m</span> axolotl.cli.train config.yml</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="rlhf-completion-table-logging" class="level3">
<h3 class="anchored" data-anchor-id="rlhf-completion-table-logging">RLHF Completion Table Logging</h3>
<p>For RLHF (Reinforcement Learning from Human Feedback) training methods like DPO, KTO, ORPO, and GRPO, SwanLab can log model completions (prompts, chosen/rejected responses, rewards) to a visual table for qualitative analysis. This helps you:</p>
<ul>
<li><strong>Inspect model behavior</strong>: See actual model outputs during training</li>
<li><strong>Debug preference learning</strong>: Compare chosen vs rejected responses</li>
<li><strong>Track reward patterns</strong>: Monitor how rewards evolve over training</li>
<li><strong>Share examples with team</strong>: Visual tables in SwanLab dashboard</li>
</ul>
</section>
<section id="features-1" class="level3">
<h3 class="anchored" data-anchor-id="features-1">Features</h3>
<ul>
<li>âœ… <strong>Automatic detection</strong>: Works with DPO, KTO, ORPO, GRPO trainers</li>
<li>âœ… <strong>Memory-safe buffering</strong>: Bounded buffer prevents memory leaks in long training runs</li>
<li>âœ… <strong>Periodic logging</strong>: Configurable logging interval to reduce overhead</li>
<li>âœ… <strong>Rich visualization</strong>: SwanLab tables show prompts, responses, and metrics side-by-side</li>
</ul>
</section>
<section id="configuration" class="level3">
<h3 class="anchored" data-anchor-id="configuration">Configuration</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 15%">
<col style="width: 23%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>swanlab_log_completions</code></td>
<td>bool</td>
<td><code>true</code></td>
<td>Enable completion logging for RLHF trainers</td>
</tr>
<tr class="even">
<td><code>swanlab_completion_log_interval</code></td>
<td>int</td>
<td><code>100</code></td>
<td>Log completions to SwanLab every N training steps</td>
</tr>
<tr class="odd">
<td><code>swanlab_completion_max_buffer</code></td>
<td>int</td>
<td><code>128</code></td>
<td>Maximum completions to buffer (memory bound)</td>
</tr>
</tbody>
</table>
</section>
<section id="example-dpo-training-with-completion-logging" class="level3">
<h3 class="anchored" data-anchor-id="example-dpo-training-with-completion-logging">Example: DPO Training with Completion Logging</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb44"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.swanlab.SwanLabPlugin</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> dpo-training</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_experiment_name</span><span class="kw">:</span><span class="at"> llama-3-dpo-v1</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_mode</span><span class="kw">:</span><span class="at"> cloud</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_log_completions</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_completion_log_interval</span><span class="kw">:</span><span class="at"> </span><span class="dv">100</span><span class="co">  # Log every 100 steps</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_completion_max_buffer</span><span class="kw">:</span><span class="at"> </span><span class="dv">128</span><span class="co">    # Keep last 128 completions</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rl</span><span class="kw">:</span><span class="at"> dpo</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="fu">datasets</span><span class="kw">:</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">path</span><span class="kw">:</span><span class="at"> /path/to/preference_dataset</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> chatml.intel</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="example-disable-completion-logging" class="level3">
<h3 class="anchored" data-anchor-id="example-disable-completion-logging">Example: Disable Completion Logging</h3>
<p>If youâ€™re doing a quick test run or donâ€™t need completion tables:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb45"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.swanlab.SwanLabPlugin</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> dpo-training</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_log_completions</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="supported-rlhf-trainers" class="level3">
<h3 class="anchored" data-anchor-id="supported-rlhf-trainers">Supported RLHF Trainers</h3>
<p>The completion logging callback automatically activates for these trainer types:</p>
<ul>
<li><strong>DPO (Direct Preference Optimization)</strong>: Logs prompts, chosen, rejected, reward_diff</li>
<li><strong>KTO (Kahneman-Tversky Optimization)</strong>: Logs prompts, completions, labels, rewards</li>
<li><strong>ORPO (Odds Ratio Preference Optimization)</strong>: Logs prompts, chosen, rejected, log_odds_ratio</li>
<li><strong>GRPO (Group Relative Policy Optimization)</strong>: Logs prompts, completions, rewards, advantages</li>
<li><strong>CPO (Constrained Policy Optimization)</strong>: Logs prompts, chosen, rejected</li>
</ul>
<p>For non-RLHF trainers (standard supervised fine-tuning), the completion callback is automatically skipped.</p>
</section>
<section id="how-it-works-2" class="level3">
<h3 class="anchored" data-anchor-id="how-it-works-2">How It Works</h3>
<ol type="1">
<li><strong>Auto-detection</strong>: Plugin detects trainer type at initialization</li>
<li><strong>Buffering</strong>: Completions are buffered in memory (up to <code>swanlab_completion_max_buffer</code>)</li>
<li><strong>Periodic logging</strong>: Every <code>swanlab_completion_log_interval</code> steps, buffer is logged to SwanLab</li>
<li><strong>Memory safety</strong>: Old completions are automatically dropped when buffer is full (uses <code>collections.deque</code>)</li>
<li><strong>Final flush</strong>: Remaining completions are logged when training completes</li>
</ol>
</section>
<section id="viewing-completion-tables" class="level3">
<h3 class="anchored" data-anchor-id="viewing-completion-tables">Viewing Completion Tables</h3>
<p>After training starts, you can view completion tables in your SwanLab dashboard:</p>
<ol type="1">
<li>Navigate to your experiment in SwanLab</li>
<li>Look for the â€œrlhf_completionsâ€ table in the metrics panel</li>
<li>The table shows:
<ul>
<li><strong>step</strong>: Training step when completion was generated</li>
<li><strong>prompt</strong>: Input prompt</li>
<li><strong>chosen</strong>: Preferred response (DPO/ORPO)</li>
<li><strong>rejected</strong>: Non-preferred response (DPO/ORPO)</li>
<li><strong>completion</strong>: Model output (KTO/GRPO)</li>
<li><strong>reward_diff/reward</strong>: Reward metrics</li>
<li>Trainer-specific metrics (e.g., log_odds_ratio for ORPO)</li>
</ul></li>
</ol>
</section>
<section id="memory-management" class="level3">
<h3 class="anchored" data-anchor-id="memory-management">Memory Management</h3>
<p>The completion buffer is <strong>memory-bounded</strong> to prevent memory leaks:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> deque</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="bu">buffer</span> <span class="op">=</span> deque(maxlen<span class="op">=</span><span class="dv">128</span>)  <span class="co"># Old completions automatically dropped</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Memory usage estimate</strong>:
- Average completion: ~500 characters (prompt + responses)
- Buffer size 128: ~64 KB (negligible)
- Buffer size 1024: ~512 KB (still small)</p>
<p><strong>Recommendation</strong>: Default buffer size (128) works well for most cases. Increase to 512-1024 only if you need to review more historical completions.</p>
</section>
<section id="performance-impact" class="level3">
<h3 class="anchored" data-anchor-id="performance-impact">Performance Impact</h3>
<p>Completion logging has minimal overhead:</p>
<ul>
<li><strong>Buffering</strong>: O(1) append operation, negligible CPU/memory</li>
<li><strong>Logging</strong>: Only happens every N steps (default: 100)</li>
<li><strong>Network</strong>: SwanLab batches table uploads efficiently</li>
</ul>
<p><strong>Expected overhead</strong>: &lt; 0.5% per training step</p>
</section>
<section id="troubleshooting" class="level3">
<h3 class="anchored" data-anchor-id="troubleshooting">Troubleshooting</h3>
<section id="completions-not-appearing-in-swanlab" class="level4">
<h4 class="anchored" data-anchor-id="completions-not-appearing-in-swanlab">Completions not appearing in SwanLab</h4>
<p><strong>Cause</strong>: Trainer may not be logging completion data in the expected format.</p>
<p><strong>Diagnostic steps</strong>:
1. Check trainer type detection in logs:
<code>text    INFO: SwanLab RLHF completion logging enabled for DPOTrainer (type: dpo)</code>
2. Verify your trainer is an RLHF trainer (DPO/KTO/ORPO/GRPO)
3. Check if trainer logs completion data (this depends on TRL version)</p>
<p><strong>Note</strong>: The current implementation expects trainers to log completion data in the <code>logs</code> dict during <code>on_log()</code> callback. Some TRL trainers may not expose this data by default. You may need to patch the trainer to expose completions.</p>
</section>
<section id="buffer-fills-up-too-quickly" class="level4">
<h4 class="anchored" data-anchor-id="buffer-fills-up-too-quickly">Buffer fills up too quickly</h4>
<p><strong>Cause</strong>: High logging frequency with small buffer size.</p>
<p><strong>Solution</strong>: Increase buffer size or logging interval:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb47"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_completion_log_interval</span><span class="kw">:</span><span class="at"> </span><span class="dv">200</span><span class="co">  # Log less frequently</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_completion_max_buffer</span><span class="kw">:</span><span class="at"> </span><span class="dv">512</span><span class="co">    # Larger buffer</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="memory-usage-growing-over-time" class="level4">
<h4 class="anchored" data-anchor-id="memory-usage-growing-over-time">Memory usage growing over time</h4>
<p><strong>Cause</strong>: Buffer should be bounded, so this indicates a bug.</p>
<p><strong>Solution</strong>:
1. Verify <code>swanlab_completion_max_buffer</code> is set
2. Check SwanLab version is up to date
3. Report issue with memory profiling data</p>
</section>
</section>
<section id="performance-profiling" class="level3">
<h3 class="anchored" data-anchor-id="performance-profiling">Performance Profiling</h3>
<p>SwanLab integration includes profiling utilities to measure and log execution time of trainer methods. This helps you:</p>
<ul>
<li><strong>Identify bottlenecks</strong>: Find slow operations in your training loop</li>
<li><strong>Optimize performance</strong>: Track improvements after optimization changes</li>
<li><strong>Monitor distributed training</strong>: See per-rank timing differences</li>
<li><strong>Debug hangs</strong>: Detect methods that take unexpectedly long</li>
</ul>
</section>
<section id="features-2" class="level3">
<h3 class="anchored" data-anchor-id="features-2">Features</h3>
<ul>
<li>âœ… <strong>Zero-config profiling</strong>: Automatic timing of key trainer methods</li>
<li>âœ… <strong>Decorator-based</strong>: Easy to add profiling to custom methods with <code>@swanlab_profile</code></li>
<li>âœ… <strong>Context manager</strong>: Fine-grained profiling with <code>swanlab_profiling_context()</code></li>
<li>âœ… <strong>Advanced filtering</strong>: <code>ProfilingConfig</code> for throttling and minimum duration thresholds</li>
<li>âœ… <strong>Exception-safe</strong>: Logs duration even if function raises an exception</li>
</ul>
</section>
<section id="basic-usage-decorator" class="level3">
<h3 class="anchored" data-anchor-id="basic-usage-decorator">Basic Usage: Decorator</h3>
<p>Add profiling to any trainer method with the <code>@swanlab_profile</code> decorator:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> axolotl.integrations.swanlab.profiling <span class="im">import</span> swanlab_profile</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MyCustomTrainer(AxolotlTrainer):</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">@swanlab_profile</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> training_step(<span class="va">self</span>, model, inputs):</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Your training step logic</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">super</span>().training_step(model, inputs)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">@swanlab_profile</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> prediction_step(<span class="va">self</span>, model, inputs, prediction_loss_only):</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Your prediction logic</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">super</span>().prediction_step(model, inputs, prediction_loss_only)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The decorator automatically:
1. Measures execution time with high-precision timer
2. Logs to SwanLab as <code>profiling/Time taken: ClassName.method_name</code>
3. Only logs if SwanLab is enabled (<code>use_swanlab: true</code>)
4. Gracefully handles exceptions (logs duration, then re-raises)</p>
</section>
<section id="advanced-usage-context-manager" class="level3">
<h3 class="anchored" data-anchor-id="advanced-usage-context-manager">Advanced Usage: Context Manager</h3>
<p>For fine-grained profiling within a method:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> axolotl.integrations.swanlab.profiling <span class="im">import</span> swanlab_profiling_context</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MyTrainer(AxolotlTrainer):</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> complex_training_step(<span class="va">self</span>, model, inputs):</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Profile just the forward pass</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> swanlab_profiling_context(<span class="va">self</span>, <span class="st">"forward_pass"</span>):</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>            outputs <span class="op">=</span> model(<span class="op">**</span>inputs)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Profile just the backward pass</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> swanlab_profiling_context(<span class="va">self</span>, <span class="st">"backward_pass"</span>):</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> outputs.loss</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> outputs</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="advanced-usage-profilingconfig" class="level3">
<h3 class="anchored" data-anchor-id="advanced-usage-profilingconfig">Advanced Usage: ProfilingConfig</h3>
<p>Filter and throttle profiling logs with <code>ProfilingConfig</code>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> axolotl.integrations.swanlab.profiling <span class="im">import</span> (</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    swanlab_profiling_context_advanced,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    ProfilingConfig,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>profiling_config <span class="op">=</span> ProfilingConfig(</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    enabled<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    min_duration_ms<span class="op">=</span><span class="fl">1.0</span>,    <span class="co"># Only log if duration &gt; 1ms</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    log_interval<span class="op">=</span><span class="dv">10</span>,        <span class="co"># Log every 10th call</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MyTrainer(AxolotlTrainer):</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> frequently_called_method(<span class="va">self</span>, data):</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> swanlab_profiling_context_advanced(</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>,</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">"frequent_op"</span>,</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>            config<span class="op">=</span>profiling_config</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>        ):</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>            <span class="co"># This only logs every 10th call, and only if it takes &gt; 1ms</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>            result <span class="op">=</span> expensive_computation(data)</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> result</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>ProfilingConfig Parameters</strong>:
- <code>enabled</code>: Enable/disable profiling globally (default: <code>True</code>)
- <code>min_duration_ms</code>: Minimum duration to log in milliseconds (default: <code>0.1</code>)
- <code>log_interval</code>: Log every Nth function call (default: <code>1</code> = log all)</p>
<p><strong>Use cases</strong>:
- <strong>High-frequency methods</strong>: Use <code>log_interval=100</code> to reduce logging overhead
- <strong>Filter noise</strong>: Use <code>min_duration_ms=1.0</code> to skip very fast operations
- <strong>Debugging</strong>: Use <code>log_interval=1, min_duration_ms=0.0</code> to log everything</p>
</section>
<section id="viewing-profiling-metrics" class="level3">
<h3 class="anchored" data-anchor-id="viewing-profiling-metrics">Viewing Profiling Metrics</h3>
<p>In your SwanLab dashboard, profiling metrics appear under the â€œprofilingâ€ namespace:</p>
<pre class="text"><code>profiling/Time taken: AxolotlTrainer.training_step
profiling/Time taken: AxolotlTrainer.prediction_step
profiling/Time taken: MyTrainer.forward_pass
profiling/Time taken: MyTrainer.backward_pass</code></pre>
<p>You can:
- <strong>Track over time</strong>: See if methods get faster/slower during training
- <strong>Compare runs</strong>: Compare profiling metrics across experiments
- <strong>Identify regressions</strong>: Detect if a code change slowed down training</p>
</section>
<section id="configuration-in-axolotl-config" class="level3">
<h3 class="anchored" data-anchor-id="configuration-in-axolotl-config">Configuration in Axolotl Config</h3>
<p>Profiling is automatically enabled when SwanLab is enabled. No additional config needed:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb52"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.swanlab.SwanLabPlugin</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>To disable profiling while keeping SwanLab enabled:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> axolotl.integrations.swanlab.profiling <span class="im">import</span> DEFAULT_PROFILING_CONFIG</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>DEFAULT_PROFILING_CONFIG.enabled <span class="op">=</span> <span class="va">False</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="performance-impact-1" class="level3">
<h3 class="anchored" data-anchor-id="performance-impact-1">Performance Impact</h3>
<ul>
<li><strong>Decorator overhead</strong>: ~2-5 microseconds per call (negligible)</li>
<li><strong>Context manager overhead</strong>: ~1-3 microseconds (negligible)</li>
<li><strong>Logging overhead</strong>: Only when SwanLab is enabled and method duration exceeds threshold</li>
<li><strong>Network overhead</strong>: SwanLab batches metrics efficiently</li>
</ul>
<p><strong>Expected overhead</strong>: &lt; 0.1% per training step (effectively zero)</p>
</section>
<section id="best-practices" class="level3">
<h3 class="anchored" data-anchor-id="best-practices">Best Practices</h3>
<ol type="1">
<li><strong>Profile bottlenecks first</strong>: Start by profiling suspected slow operations</li>
<li><strong>Use min_duration_ms</strong>: Filter out fast operations (&lt; 1ms) to reduce noise</li>
<li><strong>Throttle high-frequency calls</strong>: Use <code>log_interval</code> for methods called &gt; 100 times/step</li>
<li><strong>Profile across runs</strong>: Compare profiling metrics before/after optimization</li>
<li><strong>Monitor distributed training</strong>: Check for rank-specific slowdowns</li>
</ol>
</section>
<section id="example-complete-profiling-setup" class="level3">
<h3 class="anchored" data-anchor-id="example-complete-profiling-setup">Example: Complete Profiling Setup</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> axolotl.integrations.swanlab.profiling <span class="im">import</span> (</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>    swanlab_profile,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    swanlab_profiling_context,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    ProfilingConfig,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> OptimizedTrainer(AxolotlTrainer):</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, <span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Custom profiling config for high-frequency operations</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fast_op_config <span class="op">=</span> ProfilingConfig(</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>            enabled<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>            min_duration_ms<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>            log_interval<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">@swanlab_profile</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> training_step(<span class="va">self</span>, model, inputs):</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Main training step - always profile."""</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">super</span>().training_step(model, inputs)</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">@swanlab_profile</span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> compute_loss(<span class="va">self</span>, model, inputs, return_outputs<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""Loss computation - always profile."""</span></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">super</span>().compute_loss(model, inputs, return_outputs)</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _prepare_inputs(<span class="va">self</span>, inputs):</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""High-frequency operation - throttled profiling."""</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> swanlab_profiling_context_advanced(</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>,</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">"prepare_inputs"</span>,</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>            config<span class="op">=</span><span class="va">self</span>.fast_op_config,</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>        ):</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">super</span>()._prepare_inputs(inputs)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="troubleshooting-1" class="level3">
<h3 class="anchored" data-anchor-id="troubleshooting-1">Troubleshooting</h3>
<section id="profiling-metrics-not-appearing-in-swanlab" class="level4">
<h4 class="anchored" data-anchor-id="profiling-metrics-not-appearing-in-swanlab">Profiling metrics not appearing in SwanLab</h4>
<p><strong>Cause</strong>: SwanLab is not enabled or not initialized.</p>
<p><strong>Solution</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb55"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Check logs for:</p>
<pre class="text"><code>INFO: SwanLab initialized for project: my-project</code></pre>
</section>
<section id="too-many-profiling-metrics-cluttering-dashboard" class="level4">
<h4 class="anchored" data-anchor-id="too-many-profiling-metrics-cluttering-dashboard">Too many profiling metrics cluttering dashboard</h4>
<p><strong>Cause</strong>: Profiling every function call for high-frequency operations.</p>
<p><strong>Solution</strong>: Use <code>ProfilingConfig</code> with throttling:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>config <span class="op">=</span> ProfilingConfig(</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    min_duration_ms<span class="op">=</span><span class="fl">1.0</span>,    <span class="co"># Skip fast ops</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    log_interval<span class="op">=</span><span class="dv">100</span>,       <span class="co"># Log every 100th call</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="profiling-overhead-impacting-training-speed" class="level4">
<h4 class="anchored" data-anchor-id="profiling-overhead-impacting-training-speed">Profiling overhead impacting training speed</h4>
<p><strong>Cause</strong>: Profiling itself should have negligible overhead (&lt; 0.1%). If you see &gt; 1% slowdown, this indicates a bug.</p>
<p><strong>Solution</strong>:
1. Disable profiling temporarily to confirm:
<code>python    DEFAULT_PROFILING_CONFIG.enabled = False</code>
2. Report issue with profiling data and trainer details</p>
</section>
<section id="profiling-shows-inconsistent-timing" class="level4">
<h4 class="anchored" data-anchor-id="profiling-shows-inconsistent-timing">Profiling shows inconsistent timing</h4>
<p><strong>Cause</strong>: Normal variation due to GPU warmup, data loading, or system load.</p>
<p><strong>Solution</strong>:
- Ignore first few steps (warmup period)
- Look at average/median timing over many steps
- Use <code>log_interval</code> to reduce noise from individual outliers</p>
</section>
</section>
<section id="complete-config-example" class="level3">
<h3 class="anchored" data-anchor-id="complete-config-example">Complete Config Example</h3>
<p>Hereâ€™s a complete example integrating SwanLab with your RVQ-Alpha training:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb58"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">base_model</span><span class="kw">:</span><span class="at"> /path/to/your/model</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_type</span><span class="kw">:</span><span class="at"> Qwen2ForCausalLM</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.swanlab.SwanLabPlugin</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.cut_cross_entropy.CutCrossEntropyPlugin</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> RVQ-Alpha-Training</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_experiment_name</span><span class="kw">:</span><span class="at"> Qwen2.5-7B-MetaQA-Perturb-P020</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_description</span><span class="kw">:</span><span class="at"> </span><span class="st">"Training on MetaQA and Perturbation datasets with NEW-RVQ encoding"</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_mode</span><span class="kw">:</span><span class="at"> cloud</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_workspace</span><span class="kw">:</span><span class="at"> single-cell-genomics</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="fu">sequence_len</span><span class="kw">:</span><span class="at"> </span><span class="dv">32768</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="fu">micro_batch_size</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a><span class="fu">gradient_accumulation_steps</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="fu">num_epochs</span><span class="kw">:</span><span class="at"> </span><span class="dv">2</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a><span class="fu">learning_rate</span><span class="kw">:</span><span class="at"> </span><span class="fl">2e-5</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a><span class="fu">optimizer</span><span class="kw">:</span><span class="at"> adamw_torch_fused</span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a><span class="fu">datasets</span><span class="kw">:</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">path</span><span class="kw">:</span><span class="at"> /path/to/dataset</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> chat_template</span></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a><span class="fu">output_dir</span><span class="kw">:</span><span class="at"> ./outputs</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="modes-explained" class="level3">
<h3 class="anchored" data-anchor-id="modes-explained">Modes Explained</h3>
</section>
<section id="cloud-mode-default" class="level3">
<h3 class="anchored" data-anchor-id="cloud-mode-default"><code>cloud</code> Mode (Default)</h3>
<ul>
<li>Syncs experiments to SwanLab cloud in real-time</li>
<li>Requires API key and internet connection</li>
<li>Best for: Team collaboration, remote monitoring</li>
</ul>
</section>
<section id="local-mode" class="level3">
<h3 class="anchored" data-anchor-id="local-mode"><code>local</code> Mode</h3>
<ul>
<li>Saves experiments locally only</li>
<li>No cloud sync</li>
<li>Best for: Local development, air-gapped environments</li>
</ul>
</section>
<section id="offline-mode" class="level3">
<h3 class="anchored" data-anchor-id="offline-mode"><code>offline</code> Mode</h3>
<ul>
<li>Saves metadata locally</li>
<li>Can sync to cloud later using <code>swanlab sync</code></li>
<li>Best for: Unstable internet, sync later</li>
</ul>
</section>
<section id="disabled-mode" class="level3">
<h3 class="anchored" data-anchor-id="disabled-mode"><code>disabled</code> Mode</h3>
<ul>
<li>Turns off SwanLab completely</li>
<li>No logging or tracking</li>
<li>Best for: Debugging, testing</li>
</ul>
</section>
<section id="configuration-validation-conflict-detection" class="level3">
<h3 class="anchored" data-anchor-id="configuration-validation-conflict-detection">Configuration Validation &amp; Conflict Detection</h3>
<p>SwanLab integration includes comprehensive validation and conflict detection to help you catch configuration errors early and avoid performance issues.</p>
</section>
<section id="required-fields-validation" class="level3">
<h3 class="anchored" data-anchor-id="required-fields-validation">Required Fields Validation</h3>
<p>The plugin validates your configuration at startup and provides clear error messages with solutions:</p>
<section id="missing-project-name" class="level4">
<h4 class="anchored" data-anchor-id="missing-project-name">Missing Project Name</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb59"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Solution</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb60"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="invalid-mode" class="level4">
<h4 class="anchored" data-anchor-id="invalid-mode">Invalid Mode</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb61"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_mode</span><span class="kw">:</span><span class="at"> invalid-mode</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Solution</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb62"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_mode</span><span class="kw">:</span><span class="at"> cloud</span><span class="co">  # or: local, offline, disabled</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="empty-project-name" class="level4">
<h4 class="anchored" data-anchor-id="empty-project-name">Empty Project Name</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb63"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> </span><span class="st">""</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Solution</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb64"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="cloud-mode-api-key-warning" class="level3">
<h3 class="anchored" data-anchor-id="cloud-mode-api-key-warning">Cloud Mode API Key Warning</h3>
<p>When using <code>cloud</code> mode without an API key, youâ€™ll receive a warning with multiple solutions:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb65"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_mode</span><span class="kw">:</span><span class="at"> cloud</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Solutions</strong>:
1. Set environment variable: <code>export SWANLAB_API_KEY=your-api-key</code>
2. Add to config (less secure): <code>swanlab_api_key: your-api-key</code>
3. Run <code>swanlab login</code> before training
4. Use <code>swanlab_mode: local</code> for offline tracking</p>
</section>
<section id="multi-logger-performance-warnings" class="level3">
<h3 class="anchored" data-anchor-id="multi-logger-performance-warnings">Multi-Logger Performance Warnings</h3>
<p>Using multiple logging tools simultaneously (SwanLab + WandB + MLflow + Comet) can impact training performance:</p>
<section id="two-loggers---warning" class="level4">
<h4 class="anchored" data-anchor-id="two-loggers---warning">Two Loggers - Warning</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb66"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">use_wandb</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">wandb_project</span><span class="kw">:</span><span class="at"> my-project</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Impact</strong>:
- Performance overhead: ~1-2% per logger (cumulative)
- Increased memory usage
- Longer training time per step
- Potential config/callback conflicts</p>
<p><strong>Recommendations</strong>:
- Choose ONE primary logging tool for production training
- Use multiple loggers only for:
- Migration period (transitioning between tools)
- Short comparison runs
- Debugging specific tool issues
- Monitor system resources (CPU, memory) during training</p>
</section>
<section id="three-loggers---error-level-warning" class="level4">
<h4 class="anchored" data-anchor-id="three-loggers---error-level-warning">Three+ Loggers - Error-Level Warning</h4>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb67"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">use_wandb</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="fu">wandb_project</span><span class="kw">:</span><span class="at"> my-project</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="fu">use_mlflow</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mlflow_tracking_uri</span><span class="kw">:</span><span class="at"> http://localhost:5000</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Why This Matters</strong>:
- With 3 loggers: ~4-5% overhead per step â†’ significant slowdown over long training
- Example: 10,000 steps at 2s/step â†’ ~400-500 seconds extra (6-8 minutes)
- Memory overhead scales with number of loggers
- Rare edge cases with callback ordering conflicts</p>
</section>
</section>
<section id="auto-enable-logic" class="level3">
<h3 class="anchored" data-anchor-id="auto-enable-logic">Auto-Enable Logic</h3>
<p>For convenience, SwanLab will auto-enable if you specify a project without setting <code>use_swanlab</code>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb68"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="distributed-training-detection" class="level3">
<h3 class="anchored" data-anchor-id="distributed-training-detection">Distributed Training Detection</h3>
<p>In distributed training scenarios (multi-GPU), the plugin automatically detects and reports:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb69"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_mode</span><span class="kw">:</span><span class="at"> cloud</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Why Only Rank 0</strong>:
- Avoids duplicate experiment runs
- Reduces network/cloud API overhead on worker ranks
- Prevents race conditions in metric logging</p>
</section>
<section id="authentication" class="level3">
<h3 class="anchored" data-anchor-id="authentication">Authentication</h3>
</section>
<section id="method-1-environment-variable-recommended" class="level3">
<h3 class="anchored" data-anchor-id="method-1-environment-variable-recommended">Method 1: Environment Variable (Recommended)</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb70"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="bu">export</span> <span class="va">SWANLAB_API_KEY</span><span class="op">=</span>your-api-key-here</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="method-2-login-command" class="level3">
<h3 class="anchored" data-anchor-id="method-2-login-command">Method 2: Login Command</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb71"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="ex">swanlab</span> login</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="method-3-config-file" class="level3">
<h3 class="anchored" data-anchor-id="method-3-config-file">Method 3: Config File</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb72"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_api_key</span><span class="kw">:</span><span class="at"> your-api-key-here</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="what-gets-logged" class="level3">
<h3 class="anchored" data-anchor-id="what-gets-logged">What Gets Logged?</h3>
</section>
<section id="automatically-logged-metrics" class="level3">
<h3 class="anchored" data-anchor-id="automatically-logged-metrics">Automatically Logged Metrics</h3>
<ul>
<li>Training loss</li>
<li>Learning rate</li>
<li>Gradient norm</li>
<li>Training steps</li>
<li>Epoch progress</li>
</ul>
</section>
<section id="automatically-logged-config" class="level3">
<h3 class="anchored" data-anchor-id="automatically-logged-config">Automatically Logged Config</h3>
<ul>
<li>Model configuration (base_model, model_type)</li>
<li>Training hyperparameters (learning_rate, batch_size, etc.)</li>
<li>Optimizer settings</li>
<li>Parallelization settings (FSDP, DeepSpeed, Context Parallel)</li>
<li>Axolotl configuration file</li>
<li>DeepSpeed configuration (if used)</li>
</ul>
</section>
<section id="viewing-your-experiments" class="level3">
<h3 class="anchored" data-anchor-id="viewing-your-experiments">Viewing Your Experiments</h3>
</section>
<section id="cloud-mode" class="level3">
<h3 class="anchored" data-anchor-id="cloud-mode">Cloud Mode</h3>
<p>Visit <a href="https://swanlab.cn">https://swanlab.cn</a> and navigate to your project to view:
- Real-time training metrics
- Hyperparameter comparison
- System resource usage
- Configuration files</p>
</section>
<section id="local-mode-1" class="level3">
<h3 class="anchored" data-anchor-id="local-mode-1">Local Mode</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb73"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="ex">swanlab</span> watch ./swanlog</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="integration-with-existing-tools" class="level3">
<h3 class="anchored" data-anchor-id="integration-with-existing-tools">Integration with Existing Tools</h3>
<p>SwanLab can work alongside other tracking tools:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb74"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.swanlab.SwanLabPlugin</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="fu">use_wandb</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="fu">wandb_project</span><span class="kw">:</span><span class="at"> my-project</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="troubleshooting-2" class="level3">
<h3 class="anchored" data-anchor-id="troubleshooting-2">Troubleshooting</h3>
</section>
<section id="configuration-errors" class="level3">
<h3 class="anchored" data-anchor-id="configuration-errors">Configuration Errors</h3>
<section id="error-swanlab-enabled-but-swanlab_project-is-not-set" class="level4">
<h4 class="anchored" data-anchor-id="error-swanlab-enabled-but-swanlab_project-is-not-set">Error: â€œSwanLab enabled but â€˜swanlab_projectâ€™ is not setâ€</h4>
<p><strong>Cause</strong>: You enabled SwanLab (<code>use_swanlab: true</code>) but forgot to specify a project name.</p>
<p><strong>Solution</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb75"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span><span class="co">  # Add this line</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="error-invalid-swanlab_mode-xxx" class="level4">
<h4 class="anchored" data-anchor-id="error-invalid-swanlab_mode-xxx">Error: â€œInvalid swanlab_mode: â€˜xxxâ€™â€</h4>
<p><strong>Cause</strong>: You provided an invalid mode value.</p>
<p><strong>Solution</strong>: Use one of the valid modes:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb76"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_mode</span><span class="kw">:</span><span class="at"> cloud</span><span class="co">     # or: local, offline, disabled</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="error-swanlab_project-cannot-be-an-empty-string" class="level4">
<h4 class="anchored" data-anchor-id="error-swanlab_project-cannot-be-an-empty-string">Error: â€œswanlab_project cannot be an empty stringâ€</h4>
<p><strong>Cause</strong>: You set <code>swanlab_project: ""</code> (empty string).</p>
<p><strong>Solution</strong>: Either provide a valid name or remove the field:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb77"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="import-errors" class="level3">
<h3 class="anchored" data-anchor-id="import-errors">Import Errors</h3>
<section id="error-swanlab-is-not-installed" class="level4">
<h4 class="anchored" data-anchor-id="error-swanlab-is-not-installed">Error: â€œSwanLab is not installedâ€</h4>
<p><strong>Cause</strong>: SwanLab package is not installed in your environment.</p>
<p><strong>Solution</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb78"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install swanlab</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install swanlab<span class="op">&gt;</span>=0.3.0</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="performance-issues" class="level3">
<h3 class="anchored" data-anchor-id="performance-issues">Performance Issues</h3>
<section id="warning-multiple-logging-tools-enabled" class="level4">
<h4 class="anchored" data-anchor-id="warning-multiple-logging-tools-enabled">Warning: â€œMultiple logging tools enabledâ€</h4>
<p><strong>Cause</strong>: You have multiple experiment tracking tools enabled (e.g., SwanLab + WandB + MLflow).</p>
<p><strong>Impact</strong>: ~1-2% performance overhead per logger, cumulative.</p>
<p><strong>Solution</strong>: For production training, disable all but one logger:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb79"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">use_wandb</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span><span class="co">      # Disable others</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="fu">use_mlflow</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="fu">use_wandb</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="fu">wandb_project</span><span class="kw">:</span><span class="at"> my-project</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Exception</strong>: Multiple loggers are acceptable for:
- Short comparison runs (&lt; 100 steps)
- Migration testing between logging tools
- Debugging logger-specific issues</p>
</section>
</section>
<section id="distributed-training-issues" class="level3">
<h3 class="anchored" data-anchor-id="distributed-training-issues">Distributed Training Issues</h3>
<section id="swanlab-creates-duplicate-runs-in-multi-gpu-training" class="level4">
<h4 class="anchored" data-anchor-id="swanlab-creates-duplicate-runs-in-multi-gpu-training">SwanLab creates duplicate runs in multi-GPU training</h4>
<p><strong>Cause</strong>: All ranks are initializing SwanLab instead of just rank 0.</p>
<p><strong>Expected Behavior</strong>: The plugin automatically ensures only rank 0 initializes SwanLab. You should see:</p>
<pre class="text"><code>Info: Distributed training detected (world_size=4)
Info: Only rank 0 will initialize SwanLab
Info: Other ranks will skip SwanLab to avoid conflicts</code></pre>
<p><strong>If you see duplicates</strong>:
1. Check your plugin is loaded correctly
2. Verify youâ€™re using the latest SwanLab integration code
3. Check logs for initialization messages on all ranks</p>
</section>
</section>
<section id="swanlab-not-logging-metrics" class="level3">
<h3 class="anchored" data-anchor-id="swanlab-not-logging-metrics">SwanLab not logging metrics</h3>
<p><strong>Solution</strong>: Ensure SwanLab is initialized before training starts. The plugin automatically handles this in <code>pre_model_load</code>.</p>
</section>
<section id="api-key-errors" class="level3">
<h3 class="anchored" data-anchor-id="api-key-errors">API Key errors</h3>
<p><strong>Solution</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb81"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="va">$SWANLAB_API_KEY</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="ex">swanlab</span> login</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="cloud-sync-issues" class="level3">
<h3 class="anchored" data-anchor-id="cloud-sync-issues">Cloud sync issues</h3>
<p><strong>Solution</strong>: Use <code>offline</code> mode and sync later:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb82"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_mode</span><span class="kw">:</span><span class="at"> offline</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Then sync when ready:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb83"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="ex">swanlab</span> sync ./swanlog</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="plugin-not-loaded" class="level3">
<h3 class="anchored" data-anchor-id="plugin-not-loaded">Plugin not loaded</h3>
<p><strong>Solution</strong>: Verify plugin path in config:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb84"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.swanlab.SwanLabPlugin</span><span class="co">  # Correct path</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="lark-notification-issues" class="level3">
<h3 class="anchored" data-anchor-id="lark-notification-issues">Lark Notification Issues</h3>
<section id="error-failed-to-import-swanlab-lark-plugin" class="level4">
<h4 class="anchored" data-anchor-id="error-failed-to-import-swanlab-lark-plugin">Error: â€œFailed to import SwanLab Lark pluginâ€</h4>
<p><strong>Cause</strong>: Your SwanLab version doesnâ€™t include the Lark plugin (requires SwanLab &gt;= 0.3.0).</p>
<p><strong>Solution</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb85"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="at">--upgrade</span> swanlab</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="st">'swanlab&gt;=0.3.0'</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="warning-lark-webhook-has-no-secret-configured" class="level4">
<h4 class="anchored" data-anchor-id="warning-lark-webhook-has-no-secret-configured">Warning: â€œLark webhook has no secret configuredâ€</h4>
<p><strong>Cause</strong>: You provided <code>swanlab_lark_webhook_url</code> but no <code>swanlab_lark_secret</code>.</p>
<p><strong>Impact</strong>: Lark notifications will work, but without HMAC authentication (security risk).</p>
<p><strong>Solution</strong>: Add HMAC secret for production use:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb86"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_lark_webhook_url</span><span class="kw">:</span><span class="at"> https://open.feishu.cn/open-apis/bot/v2/hook/xxx</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_lark_secret</span><span class="kw">:</span><span class="at"> your-webhook-secret</span><span class="co">  # Add this line</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>When itâ€™s OK to skip secret</strong>:
- Local development and testing
- Internal networks with restricted access
- Non-sensitive training experiments</p>
<p><strong>When secret is required</strong>:
- Production training jobs
- Training with proprietary data
- Multi-team shared Lark groups</p>
</section>
<section id="error-failed-to-register-lark-callback" class="level4">
<h4 class="anchored" data-anchor-id="error-failed-to-register-lark-callback">Error: â€œFailed to register Lark callbackâ€</h4>
<p><strong>Cause</strong>: Invalid webhook URL or network connectivity issues.</p>
<p><strong>Diagnostic steps</strong>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb87"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-X</span> POST <span class="st">"YOUR_WEBHOOK_URL"</span> <span class="dt">\</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">'Content-Type: application/json'</span> <span class="dt">\</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">-d</span> <span class="st">'{"msg_type":"text","content":{"text":"Test from Axolotl"}}'</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> show swanlab</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Solution</strong>:
1. Verify webhook URL is correct (copy from Lark bot settings)
2. Check network connectivity to Lark API
3. Ensure webhook is not expired (Lark webhooks can expire)
4. Regenerate webhook URL in Lark bot settings if needed</p>
</section>
<section id="lark-notifications-not-received" class="level4">
<h4 class="anchored" data-anchor-id="lark-notifications-not-received">Lark notifications not received</h4>
<p><strong>Cause</strong>: Multiple possible causes.</p>
<p><strong>Diagnostic checklist</strong>:</p>
<ol type="1">
<li><p><strong>Check training logs</strong> for Lark registration confirmation:</p>
<pre class="text"><code># Expected log message (rank 0 only):
INFO: Registered Lark notification callback with HMAC authentication</code></pre></li>
<li><p><strong>Verify webhook in Lark</strong>: Test webhook manually (see above)</p></li>
<li><p><strong>Check distributed training</strong>: Only rank 0 sends notifications</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb89"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If running multi-GPU, check rank 0 logs specifically</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="st">"Registered Lark"</span> logs/rank_0.log</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p><strong>Verify SwanLab is initialized</strong>: Lark callback needs SwanLab to be running</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb90"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">use_swanlab</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span><span class="co">  # Must be enabled</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">swanlab_project</span><span class="kw">:</span><span class="at"> my-project</span><span class="co">  # Must be set</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p><strong>Check Lark bot permissions</strong>: Ensure bot is added to the target group chat</p></li>
</ol>
</section>
<section id="duplicate-lark-notifications-in-multi-gpu-training" class="level4">
<h4 class="anchored" data-anchor-id="duplicate-lark-notifications-in-multi-gpu-training">Duplicate Lark notifications in multi-GPU training</h4>
<p><strong>Expected Behavior</strong>: Should NOT happen - only rank 0 sends notifications.</p>
<p><strong>If you see duplicates</strong>:
1. Check that all GPUs are using the same config file
2. Verify plugin is loaded correctly on all ranks
3. Check logs for unexpected Lark initialization on non-zero ranks
4. Ensure <code>RANK</code> or <code>LOCAL_RANK</code> environment variables are set correctly</p>
<p><strong>Solution</strong>: This is a bug if it occurs. Report with:
- Full training command
- Logs from all ranks
- Config file</p>
</section>
</section>
<section id="comparison-swanlab-vs-wandb" class="level3">
<h3 class="anchored" data-anchor-id="comparison-swanlab-vs-wandb">Comparison: SwanLab vs WandB</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Feature</th>
<th>SwanLab</th>
<th>WandB</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Open Source</td>
<td>âœ… Yes</td>
<td>âŒ No</td>
</tr>
<tr class="even">
<td>Self-Hosting</td>
<td>âœ… Easy</td>
<td>âš ï¸ Complex</td>
</tr>
<tr class="odd">
<td>Free Tier</td>
<td>âœ… Generous</td>
<td>âš ï¸ Limited</td>
</tr>
<tr class="even">
<td>Chinese Support</td>
<td>âœ… Native</td>
<td>âš ï¸ Limited</td>
</tr>
<tr class="odd">
<td>Offline Mode</td>
<td>âœ… Full support</td>
<td>âœ… Supported</td>
</tr>
<tr class="even">
<td>Integration</td>
<td>ðŸ†• New</td>
<td>âœ… Mature</td>
</tr>
</tbody>
</table>
</section>
<section id="advanced-usage" class="level3">
<h3 class="anchored" data-anchor-id="advanced-usage">Advanced Usage</h3>
</section>
<section id="custom-logging" class="level3">
<h3 class="anchored" data-anchor-id="custom-logging">Custom Logging</h3>
<p>You can add custom metrics in your callbacks:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> swanlab</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>swanlab.log({</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"custom_metric"</span>: value,</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"epoch"</span>: epoch_num</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="experiment-comparison" class="level3">
<h3 class="anchored" data-anchor-id="experiment-comparison">Experiment Comparison</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb92"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="ex">swanlab</span> compare run1 run2 run3</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="support" class="level3">
<h3 class="anchored" data-anchor-id="support">Support</h3>
<ul>
<li><strong>Documentation</strong>: <a href="https://docs.swanlab.cn">https://docs.swanlab.cn</a></li>
<li><strong>GitHub</strong>: <a href="https://github.com/SwanHubX/SwanLab">https://github.com/SwanHubX/SwanLab</a></li>
<li><strong>Issues</strong>: Report bugs at <a href="https://github.com/SwanHubX/SwanLab/issues">GitHub Issues</a></li>
</ul>
</section>
<section id="license" class="level3">
<h3 class="anchored" data-anchor-id="license">License</h3>
<p>This integration follows the Axolotl Community License Agreement.</p>
</section>
<section id="acknowledgements" class="level3">
<h3 class="anchored" data-anchor-id="acknowledgements">Acknowledgements</h3>
<p>This integration is built on top of:
- <a href="https://github.com/SwanHubX/SwanLab">SwanLab</a> - Experiment tracking tool
- <a href="https://github.com/huggingface/transformers">Transformers</a> - SwanLabCallback
- <a href="https://github.com/axolotl-ai-cloud/axolotl">Axolotl</a> - Training framework</p>
<p>Please see reference <a href="https://github.com/axolotl-ai-cloud/axolotl/tree/main/src/axolotl/integrations/swanlab">here</a></p>
</section>
</section>
<section id="adding-a-new-integration" class="level2">
<h2 class="anchored" data-anchor-id="adding-a-new-integration">Adding a new integration</h2>
<p>Plugins can be used to customize the behavior of the training pipeline through <a href="https://en.wikipedia.org/wiki/Hooking">hooks</a>. See <a href="https://github.com/axolotl-ai-cloud/axolotl/blob/main/src/axolotl/integrations/base.py"><code>axolotl.integrations.BasePlugin</code></a> for the possible hooks.</p>
<p>To add a new integration, please follow these steps:</p>
<ol type="1">
<li>Create a new folder in the <code>src/axolotl/integrations</code> directory.</li>
<li>Add any relevant files (<code>LICENSE</code>, <code>README.md</code>, <code>ACKNOWLEDGEMENTS.md</code>, etc.) to the new folder.</li>
<li>Add <code>__init__.py</code> and <code>args.py</code> files to the new folder.</li>
</ol>
<ul>
<li><code>__init__.py</code> should import the integration and hook into the appropriate functions.</li>
<li><code>args.py</code> should define the arguments for the integration.</li>
</ul>
<ol start="4" type="1">
<li>(If applicable) Add CPU tests under <code>tests/integrations</code> or GPU tests under <code>tests/e2e/integrations</code>.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>See <a href="https://github.com/axolotl-ai-cloud/axolotl/tree/main/src/axolotl/integrations/cut_cross_entropy">src/axolotl/integrations/cut_cross_entropy</a> for a minimal integration example.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you could not load your integration, please ensure you are pip installing in editable mode.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb93"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="at">-e</span> .</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>and correctly spelled the integration name in the config file.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb94"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plugins</span><span class="kw">:</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> axolotl.integrations.your_integration_name.YourIntegrationPlugin</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is not necessary to place your integration in the <code>integrations</code> folder. It can be in any location, so long as itâ€™s installed in a package in your python env.</p>
<p>See this repo for an example: <a href="https://github.com/axolotl-ai-cloud/diff-transformer">https://github.com/axolotl-ai-cloud/diff-transformer</a></p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/docs\.axolotl\.ai");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>